geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# AIDS related deaths
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# New HIV infections - wrapped by test reduction year
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
cumulative_years <- seq(20,50, 10)
for (cumulative_year in cumulative_years){
cumulative_values <- calc_all_cumulatives(intervention_years, cumulative_year)
write.csv(cumulative_values, paste0("results/cumulative_values_", cumulative_year,".csv"),
row.names = FALSE)
}
filepaths <- paste0("results/cumulative_values_", cumulative_years, ".csv")
temp <- lapply(filepaths, read.csv)
names(temp) <- cumulative_years
cumulative_values_all_years <- bind_rows(temp, .id = "cumulative_year")
# relative and absolute differences
cumulative_values_all_years <- cumulative_values_all_years %>%
pivot_wider(names_from = scenario, values_from = cumulative) %>%
mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
mutate(absolute_dif = intervention - baseline) %>%
pivot_longer(-(cumulative_year:test_reduction), names_to = "scenario")
# New HIV infections - wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# New HIV infections - wrapped by test reduction year
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
# AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
# Relative difference New HIV infections - wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Relative change from baseline (%) - HIV infections")  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Relative difference AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Cumulative AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Relative difference AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("AIDS-relatd deaths \nRelative change from baseline (%)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Relative difference New HIV infections - wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("HIV infections \nRelative change from baseline (%)")  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Relative difference New HIV infections - wrapped by test reduction year
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("HIV infections \nRelative change from baseline (%)")  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
# Relative difference AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("AIDS-relatd deaths \nRelative change from baseline (%)")  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Relative difference AIDS related deaths- wrapped y test reduction year
cumulative_values_all_years %>% filter(
scenario == "percent_change", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("AIDS-relatd deaths \nRelative change from baseline (%)")  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
# Absolute difference New HIV infections - wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Absolute difference HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Absolute difference New HIV infections - wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "absolute_dif", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Absolute difference HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Absolute difference AIDS related deaths- wrapped by cumulative years
cumulative_values_all_years %>% filter(
scenario == "absolute_dif", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Absolute difference AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(cumulative_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Time scale for cumulative values") +
scale_fill_discrete("Test \nreduction \nyear") + scale_color_discrete("Test \nreduction \nyear")
# Absolute difference HIV infections - wrapped by test reduction year
cumulative_values_all_years %>% filter(
scenario == "absolute_dif", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Absolute difference HIV infections (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
# Absolute difference AIDS related deaths- wrapped by test reduction year
cumulative_values_all_years %>% filter(
scenario == "absolute_dif", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Absolute difference AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")
# Absolute difference AIDS related deaths- wrapped by test reduction year
cumulative_values_all_years %>% filter(
scenario == "absolute_dif", indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario, cumulative_year) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(test_reduction, mean, fill = cumulative_year)) +
geom_line(aes(color = cumulative_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = cumulative_year), alpha = 0.10, show.legend = T) +
xlab("PITC testing reduction (%)") + scale_y_continuous("Absolute difference AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(intervention_year), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + ggtitle("Test reduction year") +
scale_fill_discrete("Cumulative \nyears \nafter \nreduction") + scale_color_discrete("Cumulative \nyears \nafter \nreduction")

) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log10", breaks = c(20, 30, 33, 40, 50), labels = c("20", "30", "Baseline", "40", "50")) +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_year <- condom_change_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.numeric(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(x = pitc_reduction_percentage, y = overall_condom_usage, z = elimination_year))
condom_heatmap_year + geom_raster(aes(fill = elimination_year), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("HIV \nelimination \nyear",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 2055) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_year + geom_raster(aes(fill = elimination_year), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("HIV \nelimination \nyear",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 2055) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log10", breaks = c(20, 30, 33, 40, 50), labels = c("20", "30", "Baseline", "40", "50")) +
xlab("PITC reduction (%)") + theme_classic()
condom_reduction_cumulative <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_cumulative.csv")
condom_reduction_cumulative.csv <- condom_reduction_cumulative.csv %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_reduction_cumulative <- condom_reduction_cumulative %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
overall_condom_usage_range
condom_promotiom_cumulative <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_promotiom_cumulative.csv")
condom_promotiom_cumulative <- read_csv("results/condom_promotiom_cumulative.csv")
condom_promotiom_cumulative <- read_csv("results/condom_promotion_cumulative.csv")
condom_reduction_cumulative <- read_csv("results/condom_reduction_cumulative.csv")
unique_future_values <- unique(condom_promotion_summary$future_value)
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_reduction_labels <- round(overall_condom_usage_range$mean,1)
condom_reduction_cumulative <- condom_reduction_cumulative %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_promotiom_cumulative <- read_csv("results/condom_promotion_cumulative.csv")
unique_future_values <- unique(condom_reduction_cumulative$future_value)
overall_condom_usage_range <- condom_reduction_cumulative %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
unique_future_values <- unique(condom_reduction_summary$future_value)
overall_condom_usage_range <- condom_reduction_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_reduction_labels <- round(overall_condom_usage_range$mean,1)
condom_reduction_cumulative <- condom_reduction_cumulative %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_usage_reduction_labels[8]
unique_future_values[8]
condom_promotiom_cumulative <- read_csv("results/condom_promotion_cumulative.csv")
unique_future_values <- unique(condom_promotion_summary$future_value)
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_reduction_labels
condom_usage_promotion_labels <- round(overall_condom_usage_range$mean,1)
condom_usage_promotion_labels
condom_promotion_cumulative <- condom_promotion_cumulative %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_promotion_cumulative <- read_csv("results/condom_promotion_cumulative.csv")
unique_future_values <- unique(condom_promotion_summary$future_value)
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
unique_future_values <- unique(condom_promotion_summary$future_value)
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_promotion_labels <- round(overall_condom_usage_range$mean,1)
condom_promotion_cumulative <- condom_promotion_cumulative %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
unique(condom_promotion_cumulative$overall_condom_usage)
condom_promotion_cumulative <- read_csv("results/condom_promotion_cumulative.csv")
unique(condom_promotion_cumulative$future_value)
unique(condom_reduction_cumulative$future_value)
View(condom_promotion_inc_elim)
View(condom_promotiom_cumulative)
View(condom_promotion_cumulative)
condom_change_cumulative <- row_bind(condom_reduction_cumulative, condom_promotion_cumulative)
condom_change_cumulative <- bind_rows(condom_reduction_cumulative, condom_promotion_cumulative)
#### correcting incorrectly saved future value ####
unique_task_names <- unique(condom_change_summary$task_name)
unique_task_names
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention")
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention")
condom_change_summary %>% filter(indicator == "CondomUsage", test_reduction == 0, pitc_reduction_year == 2025, year == 2035, scenario == "intervention")
condom_change_summary$task_name(which == unique_task_names[1])
condom_change_summary(which == unique_task_names[1])
condom_change_summary
condom_change_summary[which == unique_task_names[1]]
unique_task_names[1]
condom_change_summary$task_name[which == unique_task_names[1]]
# for (name in unique_task_names)
condom_change_summary[which(task_name == unique_task_names[1]]
# for (name in unique_task_names)
condom_change_summary[which(task_name == unique_task_names[1])]
# for (name in unique_task_names)
condom_change_summary[which(condom_change_summary$task_name == unique_task_names[1])]
which(condom_change_summary$task_name == unique_task_names[1])
# for (name in unique_task_names)
condom_change_summary[which(condom_change_summary$task_name == unique_task_names[1]),]
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[1]),]
condom_change_summary[which(condom_change_summary$task_name == unique_task_names[1]),]$overall_condom_usage
unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[1]),]$overall_condom_usage)
for (name in unique_task_names){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == name),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == name),]$overall_condom_usage$future_value <- condom_usage_value
}
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == i),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == i),]$overall_condom_usage$future_value <- condom_usage_value
}
rlang::last_error()
unique_task_names
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[1]),]$overall_condom_usage)
condom_usage_value
class(condom_usage_value)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[1]),]$overall_condom_usage$future_value
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[1]),]$future_value
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[1]),]$future_value <- condom_usage_value
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[1]),]$future_value
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[i]),]$future_value <- condom_usage_value
}
unique(condom_change_cumulative$overall_condom_usage)
1:length(unique_task_names)
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[i]),]$future_value <- condom_usage_value
}
unique(condom_change_cumulative$overall_condom_usage)
unique(condom_change_cumulative$overall_condom_usage)
unique_task_names[i]
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[2]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[2]),]$future_value <- condom_usage_value
unique(condom_change_cumulative$overall_condom_usage)
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[160]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[160]),]$future_value <- condom_usage_value
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[160]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[160]),]$future_value <- condom_usage_value
}
unique(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[160]),]$future_value
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage <- condom_usage_value
}
unique(condom_change_cumulative$overall_condom_usage)
condom_reduction_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55.0 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55.0 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
unique(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55.0 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
View(condom_change_cumulative)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55.0)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
# overall_condom_usage == 55.0) | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
unique(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == "55.0",
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
max(unique(condom_change_cumulative$overall_condom_usage))
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage > 50,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage > 50,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
condom_change_cumulative$overall_condom_usage
class(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage > 50)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 35.4,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
max(unique(condom_change_cumulative$overall_condom_usage))
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55)
source("~/Documents/HIV_EndGame_SA/scripts/interaction_epi_costs.R", echo=TRUE)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025) %>%
select(overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
select(overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
summary(mean(overall_condom_usage))
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage
View(condom_change_summary)
View(condom_change_cumulative)
condom_change_cumulative <- bind_rows(condom_reduction_cumulative, condom_promotion_cumulative)
#### correcting incorrectly saved future value ####
unique_task_names <- unique(condom_change_summary$task_name)
condom_change_summary %>% filter(indicator == "CondomUsage", test_reduction == 0, pitc_reduction_year == 2025, year == 2035, scenario == "intervention")
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage <- condom_usage_value
}
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
condom_change_cumulative[which(condom_change_summary$task_name == unique_task_names[i]),]
condom_change_cumulative
condom_change_cumulative[which(condom_change_cumulative$task_name == unique_task_names[1]),]
condom_change_cumulative <- bind_rows(condom_reduction_cumulative, condom_promotion_cumulative)
#### correcting incorrectly saved future value ####
unique_task_names <- unique(condom_change_summary$task_name)
condom_change_cumulative[which(condom_change_cumulative$task_name == unique_task_names[1]),]
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_cumulative$task_name == unique_task_names[1]),]$overall_condom_usage <- condom_usage_value
}
class(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
max(unique(condom_change_cumulative$overall_condom_usage))
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_cumulative$task_name == unique_task_names[i]),]$overall_condom_usage <- condom_usage_value
}
max(unique(condom_change_cumulative$overall_condom_usage))
(unique(condom_change_cumulative$overall_condom_usage))
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90)
unique(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
unique(condom_change_cumulative$overall_condom_usage)
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
condom_change_cumulative %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
overall_condom_usage == 55 | overall_condom_usage == 33.0 | overall_condom_usage == 20.5,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(overall_condom_usage), fill = as.factor(overall_condom_usage))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(overall_condom_usage)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional AIDS-related deaths (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage"),) +
scale_color_discrete(labels = c("Reduced condom usage", "Status quo condom usage", "Improved condom usage")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
cumulative_art_change %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year),
art_int_rate = round((1-art_int_rate),2)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
art_int_rate == 0.9 | art_int_rate == 0.78 | art_int_rate == 0.53,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(art_int_rate), fill = as.factor(art_int_rate))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(art_int_rate)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced ART retention", "Status quo ART retention", "Improved ART retention"),) +
scale_color_discrete(labels = c("Reduced ART retention", "Status quo ART retention", "Improved ART retention")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())
cumulative_art_change %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year),
art_int_rate = round((1-art_int_rate),2)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
pitc_reduction_year == 2025,
art_int_rate == 0.9 | art_int_rate == 0.78 | art_int_rate == 0.53,
test_reduction != 10, test_reduction !=30, test_reduction !=50, test_reduction !=70, test_reduction !=90) %>%
ggplot(aes(as.factor(test_reduction), mean, group = as.factor(art_int_rate), fill = as.factor(art_int_rate))) +
geom_crossbar(aes(ymin = lower_CI, ymax = upper_CI, color = as.factor(art_int_rate)), show.legend = T,width = 0.5, position = position_dodge(width = 1), alpha = 0.5) +
geom_point(aes(color = as.factor(pitc_reduction_year)), shape = 18, size =3, position = position_dodge(width = 1), show.legend = F, color = "white") +
xlab("PITC reduction (%)") + scale_y_continuous("Additional HIV infections (millions)", labels = (function(l) {round(l/1e6,1)})) +
scale_fill_discrete(labels = c("Reduced ART retention", "Status quo ART retention", "Improved ART retention"),) +
scale_color_discrete(labels = c("Reduced ART retention", "Status quo ART retention", "Improved ART retention")) +
theme_classic() +
theme(axis.text = element_text(size = 14),
axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
legend.text = element_text(size = 12)) +
theme(legend.title = element_blank())

test_reduction_cumulative %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = F) +
geom_line(aes(), show.legend = T) + theme_classic()
test_reduction_cumulative %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = T) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous(labels = (function(l) {round(l/1e6,1)}))
test_reduction_cumulative %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = T) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional HIV infections over 50 years", labels = (function(l) {round(l/1e6,1)}))
test_reduction_cumulative %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = T) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional HIV infections over 50 years",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = F) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional AIDS-related deaths over 50 years",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = T) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional HIV infections",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = F) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional AIDS-related deaths",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = T) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional HIV infections (millions)",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = F) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional AIDS-related deaths (millions)",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/test_reduction_only_cumulative.csv")
test_reduction_cumulative %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = T) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional HIV infections (millions)",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
test_reduction_cumulative %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, mean)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI),
alpha = 0.25, show.legend = F) +
geom_line(aes(), show.legend = T) + theme_classic() +
scale_y_continuous("Additional AIDS-related deaths (millions)",
labels = (function(l) {round(l/1e6,1)})) +
xlab("PITC reduction (%)")
condom_reduction_inc_elim <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_cumulative.csv")
condom_reduction_inc_elim <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_cumulative.csv")
View(condom_reduction_inc_elim)
View(condom_reduction_inc_elim)
condom_reduction_inc_elim <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_cumulative.csv")
View(condom_reduction_inc_elim)
condom_reduction_inc_elim <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_inc_elim.csv")
View(condom_reduction_inc_elim)
condom_usage_reduction_labels
condom_reduction_summary <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_summary.csv")
condom_reduction_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
overall_condom_usage_range <- condom_reduction_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
overall_condom_usage_range
condom_usage_reduction_labels <- round(overall_condom_usage_range$mean,1)
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("Year HIV eliminaton attained", n.breaks = 10, na.value = 2200,limits = c(2040, 2100)) +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
condom_usage_reduction_labels
# plotting
unique(condom_reduction_inc_elim$future_value) <- condom_usage_reduction_labels
unique(condom_reduction_inc_elim$future_value)
length(unique(condom_reduction_inc_elim$future_value))
unique(condom_reduction_inc_elim$future_value)[1]
condom_reduction_inc_elim %>% mutate(overall_condom_usage = NA)
condom_reduction_inc_elim <- condom_reduction_inc_elim %>% mutate(overall_condom_usage = NA)
for (i in 1:length(unique(condom_reduction_inc_elim$future_value))) {
if (condom_reduction_inc_elim$future_value == unique(condom_reduction_inc_elim$future_value)[i])
{condom_reduction_inc_elim$overall_condom_usage == condom_usage_reduction_labels}
}
for (i in 1:length(unique(condom_reduction_inc_elim$future_value))) {
if (condom_reduction_inc_elim$future_value == unique(condom_reduction_inc_elim$future_value)[i])
{condom_reduction_inc_elim$overall_condom_usage == condom_usage_reduction_labels[i]}
}
condom_reduction_inc_elim$future_value == unique(condom_reduction_inc_elim$future_value)[1]
1:length(unique(condom_reduction_inc_elim$future_value))
unique(condom_reduction_inc_elim$future_value)[1]
unique(condom_reduction_inc_elim$future_value)
unique_future_values <- unique(condom_reduction_inc_elim$future_value)
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = if_else(future_value == unique_future_values[1], condom_usage_reduction_labels[1]))
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = if_else(future_value == unique_future_values[1], condom_usage_reduction_labels[1], NULL))
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = if_else(future_value == unique_future_values, condom_usage_reduction_labels, NULL))
overall_condom_usage_range
condom_usage_reduction_labels
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values[1],
condom_usage_reduction_labels[1]))
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1]))
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values ~ condom_usage_reduction_labels))
condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_reduction_inc_elim <_ condom_reduction_inc_elim %>%
condom_reduction_inc_elim <- condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
unique(condom_reduction_inc_elim$overall_condom_usage)
sum(is.na(condom_reduction_inc_elim$overall_condom_usage))
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("Year HIV eliminaton attained", n.breaks = 10, na.value = 2200,limits = c(2040, 2100)) +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage))
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.factor(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("Year HIV eliminaton attained", n.breaks = 10, na.value = 2200,limits = c(2040, 2100)) +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
# hiv incidence at 2100
condom_reduction_inc_elim %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year),
condom_usage_reduction = factor(condom_usage_reduction,
levels = as.character(condom_reduction_values))) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, mean_incidence_2100, group = condom_usage_reduction, fill = condom_usage_reduction)) +
geom_line(aes(color = condom_usage_reduction)) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = condom_usage_reduction), alpha = 0.10, show.legend = F) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("HIV incidence per 1000 (15-49 years) in 2100", labels = (function(l) {round(l*1e3,1)})) +
expand_limits(y = 0) +
geom_hline(aes(yintercept = 0.001), lty = "dotted") +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
# heatmaps
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.numeric(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(x = pitc_reduction_percentage, y = overall_condom_usage, z = overall_condom_usage)) +
geom_raster(aes(fill = elimination_year), interpolate = TRUE) + geom_text(aes(label = elimination_year), color = "white", size = 2.5) +
scale_fill_continuous("HIV \nelimination \nyear",type = "viridis", limits = c(2040, 2100)) +
ylab("Overall condom usage (%)") +
xlab("PITC reduction (%)") + theme_classic()
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
condom_usage_reduction = factor(condom_usage_reduction,
labels = condom_usage_reduction_labels,
levels = as.character(condom_reduction_values))) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(x = pitc_reduction_percentage, y = condom_usage_reduction, fill = round(1000*mean_incidence_2100,2))) +
geom_raster(interpolate = TRUE) + geom_text(aes(label = round(1000*mean_incidence_2100,2)), color = "black", size = 2.5) +
scale_fill_gradient2("Mean HIV \nincidence \n(15-49y) \nper 1000 \nin 2100",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 1) +
ylab("Reduction in condom usage probability (%)") +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_inc <- condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.numeric(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(x = pitc_reduction_percentage, y = overall_condom_usage, z = log(1000*mean_incidence_2100)))
condom_heatmap_inc + geom_raster(aes(fill = log(1000*mean_incidence_2100)), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("Log mean \nHIV \nincidence \n(15-49y) \nper 1000 \nin 2100",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("PITC reduction (%)") + theme_classic()
View(condom_reduction_inc_elim)
condom_inc_elim <- find_inc_and_elimination(condom_reduction_summary)
View(condom_inc_elim)
condom_inc_elim <- find_inc_and_elimination(condom_reduction_summary)
View(reduce_condom_usage_with_test_reduction)
condom_reduction_inc_elim <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_cumulative.csv")
unique_future_values <- unique(condom_reduction_inc_elim$future_value)
#### calculating absolute condom usage values
overall_condom_usage_range <- condom_reduction_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_reduction_labels <- round(overall_condom_usage_range$mean,1)
condom_reduction_inc_elim <- condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.factor(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("Year HIV eliminaton attained", n.breaks = 10, na.value = 2200,limits = c(2040, 2100)) +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
View(condom_reduction_inc_elim)
condom_reduction_inc_elim <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_reduction_inc_elim.csv")
unique_future_values <- unique(condom_reduction_inc_elim$future_value)
#### calculating absolute condom usage values
overall_condom_usage_range <- condom_reduction_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_reduction_labels <- round(overall_condom_usage_range$mean,1)
condom_reduction_inc_elim <- condom_reduction_inc_elim %>%
mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8]))
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.factor(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("Year HIV eliminaton attained", n.breaks = 10, na.value = 2200,limits = c(2040, 2100)) +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
# hiv incidence at 2100
condom_reduction_inc_elim %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year),
condom_usage_reduction = factor(condom_usage_reduction,
levels = as.character(condom_reduction_values))) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, mean_incidence_2100, group = condom_usage_reduction, fill = condom_usage_reduction)) +
geom_line(aes(color = condom_usage_reduction)) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = condom_usage_reduction), alpha = 0.10, show.legend = F) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("HIV incidence per 1000 (15-49 years) in 2100", labels = (function(l) {round(l*1e3,1)})) +
expand_limits(y = 0) +
geom_hline(aes(yintercept = 0.001), lty = "dotted") +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
condom_heatmap_inc <- condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.numeric(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(x = pitc_reduction_percentage, y = overall_condom_usage, z = log(1000*mean_incidence_2100)))
condom_heatmap_inc + geom_raster(aes(fill = log(1000*mean_incidence_2100)), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("Log mean \nHIV \nincidence \n(15-49y) \nper 1000 \nin 2100",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_inc + geom_raster(aes(fill = log(1000*mean_incidence_2100)), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("Log mean \nHIV \nincidence \n(15-49y) \nper 1000 \nin 2100",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous() +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_inc + geom_raster(aes(fill = log(1000*mean_incidence_2100)), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("Log mean \nHIV \nincidence \n(15-49y) \nper 1000 \nin 2100",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_year <- condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.numeric(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(x = pitc_reduction_percentage, y = overall_condom_usage, z = elimination_year))
condom_heatmap_year + geom_raster(aes(fill = elimination_year), interpolate = TRUE) +
geom_contour2(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("HIV \nelimination \nyear",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 2055) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("PITC reduction (%)") + theme_classic()
condom_heatmap_year + geom_raster(aes(fill = elimination_year), interpolate = TRUE) +
geom_contour(color = "black") +
geom_text_contour(skip = 0, stroke = 0.1, stroke.colour = "white") +
scale_fill_gradient2("HIV \nelimination \nyear",
low = "blue",
mid = "#FFFFCC",
high = "#FF0000",
midpoint = 2055) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("PITC reduction (%)") + theme_classic()
condom_reduction_inc_elim %>% mutate(elimination_year = as.numeric(elimination_year),
pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.factor(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, elimination_year, group = overall_condom_usage, color = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("Year HIV eliminaton attained", n.breaks = 10, na.value = 2200,limits = c(2040, 2100)) +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
# hiv incidence at 2100
condom_reduction_inc_elim %>% mutate(pitc_reduction_year = as.factor(pitc_reduction_year),
overall_condom_usage = as.factor(overall_condom_usage)) %>%
filter(pitc_reduction_year == 2025) %>%
ggplot(aes(pitc_reduction_percentage, mean_incidence_2100, group = overall_condom_usage, fill = overall_condom_usage)) +
geom_line(aes(color = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("PITC reduction (%)") +
theme_classic() +
scale_y_continuous("HIV incidence per 1000 (15-49 years) in 2100", labels = (function(l) {round(l*1e3,1)})) +
expand_limits(y = 0) +
geom_hline(aes(yintercept = 0.001), lty = "dotted") +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 10)) +
scale_color_discrete("Condom \nusage \nprobability \ndecrease") +
facet_wrap(vars(pitc_reduction_year),labeller = as_labeller(c(`2025` = "PITC reduced in 2025",
`2030` = "PITC reduced in 2030",
`2035` = "PITC reduced in 2035",
`2040` = "PITC reduced in 2040",
`2045` = "PITC reduced in 2045",
`2050` = "PITC reduced in 2050")))
unique(as.numeric(condom_reduction_inc_elim$overall_condom_usage))

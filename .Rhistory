future_value == unique_future_values[18] ~ condom_usage_reduction_labels[18],
future_value == unique_future_values[19] ~ condom_usage_reduction_labels[19],
future_value == unique_future_values[20] ~ condom_usage_reduction_labels[20],
future_value == unique_future_values[21] ~ condom_usage_reduction_labels[21],
future_value == unique_future_values[22] ~ condom_usage_reduction_labels[22],
future_value == unique_future_values[23] ~ condom_usage_reduction_labels[23],
future_value == unique_future_values[24] ~ condom_usage_reduction_labels[24],
future_value == unique_future_values[25] ~ condom_usage_reduction_labels[25],
future_value == unique_future_values[26] ~ condom_usage_reduction_labels[26],
future_value == unique_future_values[27] ~ condom_usage_reduction_labels[27],
future_value == unique_future_values[28] ~ condom_usage_reduction_labels[28],
future_value == unique_future_values[29] ~ condom_usage_reduction_labels[29],
future_value == unique_future_values[30] ~ condom_usage_reduction_labels[30]))
condom_promotion_cumulative <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_promotion_cumulative.csv")
condom_promotion_summary <- read_csv("/Users/stefan/Documents/HIV_EndGame_SA/results/condom_promotion_summary.csv")
unique_future_values <- unique(condom_promotion_summary$future_value)
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
unique_future_values <- unique(condom_promotion_summary$future_value)
overall_condom_usage_range <- condom_promotion_summary %>% filter(indicator == "CondomUsage",
test_reduction == 0, pitc_reduction_year == 2025,
year == 2035, scenario == "intervention") %>% select(mean)
condom_usage_promotion_labels <- round(overall_condom_usage_range$mean,1)
condom_promotion_cumulative <- condom_promotion_cumulative %>% mutate(overall_condom_usage = case_when(future_value == unique_future_values[1] ~ condom_usage_reduction_labels[1],
future_value == unique_future_values[2] ~ condom_usage_reduction_labels[2],
future_value == unique_future_values[3] ~ condom_usage_reduction_labels[3],
future_value == unique_future_values[4] ~ condom_usage_reduction_labels[4],
future_value == unique_future_values[5] ~ condom_usage_reduction_labels[5],
future_value == unique_future_values[6] ~ condom_usage_reduction_labels[6],
future_value == unique_future_values[7] ~ condom_usage_reduction_labels[7],
future_value == unique_future_values[8] ~ condom_usage_reduction_labels[8],
future_value == unique_future_values[9] ~ condom_usage_reduction_labels[9],
future_value == unique_future_values[10] ~ condom_usage_reduction_labels[10],
future_value == unique_future_values[11] ~ condom_usage_reduction_labels[11],
future_value == unique_future_values[12] ~ condom_usage_reduction_labels[12],
future_value == unique_future_values[13] ~ condom_usage_reduction_labels[13],
future_value == unique_future_values[14] ~ condom_usage_reduction_labels[14],
future_value == unique_future_values[15] ~ condom_usage_reduction_labels[15],
future_value == unique_future_values[16] ~ condom_usage_reduction_labels[16],
future_value == unique_future_values[17] ~ condom_usage_reduction_labels[17],
future_value == unique_future_values[18] ~ condom_usage_reduction_labels[18],
future_value == unique_future_values[19] ~ condom_usage_reduction_labels[19],
future_value == unique_future_values[20] ~ condom_usage_reduction_labels[20],
future_value == unique_future_values[21] ~ condom_usage_reduction_labels[21],
future_value == unique_future_values[22] ~ condom_usage_reduction_labels[22],
future_value == unique_future_values[23] ~ condom_usage_reduction_labels[23],
future_value == unique_future_values[24] ~ condom_usage_reduction_labels[24],
future_value == unique_future_values[25] ~ condom_usage_reduction_labels[25],
future_value == unique_future_values[26] ~ condom_usage_reduction_labels[26],
future_value == unique_future_values[27] ~ condom_usage_reduction_labels[27],
future_value == unique_future_values[28] ~ condom_usage_reduction_labels[28],
future_value == unique_future_values[29] ~ condom_usage_reduction_labels[29],
future_value == unique_future_values[30] ~ condom_usage_reduction_labels[30]))
condom_change_cumulative <- bind_rows(condom_reduction_cumulative, condom_promotion_cumulative)
which(is.na(condom_change_cumulative$overall_condom_usage))
#### correcting incorrectly saved future value ####
unique_task_names <- unique(condom_change_summary$task_name)
for (i in 1:length(unique_task_names)){
condom_usage_value <- unique(condom_change_summary[which(condom_change_summary$task_name == unique_task_names[i]),]$overall_condom_usage)
condom_change_cumulative[which(condom_change_cumulative$task_name == unique_task_names[i]),]$overall_condom_usage <- condom_usage_value
}
unique(condom_change_cumulative$overall_condom_usage)
sum(is.na(condom_change_cumulative$overall_condom_usage))
write_csv(condom_change_cumulative, "results/condom_change_cumulative.csv")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c
fig4d
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4a
fig4b
fig4c
fig4d
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=90, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=90, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=90, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=90, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=90, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4a
fig4b
fig4c
fig4d
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention rate",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("0.1", "0.2", "0.3", "0.4","0.5", "0.6", "0.7","", "0.8", "0.9"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 8 ,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "red",
mid = "lightyellow",
high = "blue",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4bd
ggarrange(fig4ac, fig4bd, ncol = 2)
View(test_reduction_only)
run_on_cluster(pitc_reduction_years = 2025,
pitc_reduction_percentage = 100,
condom_usage_reduction = FALSE,
condom_usage_decrease = 0,
condom_decr_start = 2025,
condom_usage_promotion = FALSE,
condom_usage_increase = 0,
condom_incr_start = 2025,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = 0,
art_incr_start = 2025,
art_coverage_decrease = 0,
art_interrupt_rate_increase = 0,
art_decr_start = 2025,
cumulative_years = 75,
summary_name = "quick_test"
)
setwd("~/Documents/HIV_EndGame_SA/THEMBISAv18")
run_on_cluster(pitc_reduction_years = 2025,
pitc_reduction_percentage = 100,
condom_usage_reduction = FALSE,
condom_usage_decrease = 0,
condom_decr_start = 2025,
condom_usage_promotion = FALSE,
condom_usage_increase = 0,
condom_incr_start = 2025,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = 0,
art_incr_start = 2025,
art_coverage_decrease = 0,
art_interrupt_rate_increase = 0,
art_decr_start = 2025,
cumulative_years = 75,
summary_name = "quick_test"
)
quick_test <- read_csv("results/quick_test_cumulative.csv")
quick_test <- read_csv("results/cumulative_quick_test.csv")
View(quick_test)
4168809 / 1000
4168809 / 1000 / 1000
View(test_reduction_cumulative)
library(readr)
quick_test <- read_csv("results/quick_test.csv")
View(quick_test)
161279.500 + 166272.000
161279.500 + 166272.000 + 175530.500 + 185155.000 + 196344.500 + 205616.500 + 223732.000 + 242498.000 + 270062.000 + 292291.000 + 306454.000
161279.500 + 166272.000 + 175530.500 + 185155.000 + 196344.500 + 205616.500 + 223732.000 + 242498.000 + 270062.000 + 292291.000 + 306454.000 + 324331.500 + 341371.000 + 359927.500 + 372954.000 + 382517.000
45350.15000 + 46508.20000 + 47562.95000 + 48568.85000 + 49866.60000 + 52470.55000 + 56182.40000 + 60621.50000 + 66088.75000 + 71355.70000 + 76998.85000 + 85395.65000 + 98744.55000 + 119073.40000
45350.15000 + 46508.20000 + 47562.95000 + 48568.85000 + 49866.60000 + 52470.55000 + 56182.40000 + 60621.50000 + 66088.75000 + 71355.70000 + 76998.85000 + 85395.65000 + 98744.55000 + 119073.40000 + 143397.20000
45350.15000 + 46508.20000 + 47562.95000 + 48568.85000 + 49866.60000 + 52470.55000 + 56182.40000 + 60621.50000 + 66088.75000 + 71355.70000 + 76998.85000 + 85395.65000 + 98744.55000 + 119073.40000 + 143397.20000 + 166589.55000 + 184319.15000 + 201784.25000 + 219125.85000
45350.15000 + 46508.20000 + 47562.95000 + 48568.85000 + 49866.60000 + 52470.55000 + 56182.40000 + 60621.50000 + 66088.75000 + 71355.70000 + 76998.85000 + 85395.65000 + 98744.55000 + 119073.40000 + 143397.20000 + 166589.55000 + 184319.15000 + 201784.25000 + 219125.85000 + 225867.40000
View(test_reduction_only_inc_elim)
View(test_reduction_cumulative)
View(condom_change_cumulative)
View(cumulative_art_change)
View(art_change_inc_elim)
View(condom_change_inc_elim)
View(quick_test)
377374 / 155704
155704 / 377374
1 - 0.4125986
(1 - 0.4125986) * 100
5.55E+07 - 1.58E+07
14 E0+7 / (5.55E+07 - 1.58E+07)
14 E+7 / (5.55E+07 - 1.58E+07)
14E+07 / (5.55E+07 - 1.58E+07)
14E+06 / (5.55E+07 - 1.58E+07)
View(rollout_dictionary)
View(formatted_data)
formatted_data[["year"]]
formatted_data[["year"]][35]
formatted_data[["year"]][36]
formatted_data[["data"]][1]
formatted_data[["data"]][1,]
formatted_data[["data"]][0,1]
formatted_data[["data"]][,1]
formatted_data[["data"]][,1][36]
formatted_data[["data"]][,1][37]

LogLxWeight <- read_output(LogLxWeight)
LogLxWeight <- read.csv("LogLxWeight.txt")
View(LogLxWeight)
LogLxWeight <- read.table("~/Documents/Imperial/Research_project/HIV_EndGame_SA/THEMBISAv18/LogLxWeight.txt", quote="\"", comment.char="")
View(LogLxWeight)
min(LogLxWeight$V1)
which.min(LogLxWeight$V1)
which(min(LogLxWeight$V1 > -10000))
LogLxWeight$V1 > -10000
LogLxWeight[LogLxWeight$V1 > -10000]
which(LogLxWeight$V1 > -10000)
LogLxWeight[which(LogLxWeight$V1 > -10000)]
##  Next examining LogLikelihoods
min(LogLxWeight$V1)
which.min(LogLxWeight$V1) #
View(LogLxWeight)
View(LogLxWeight)
View(TotalHIV)
formatted_data$data[,which(dictionary$name == "rate_first_test_neg_fem_under_25")]
run_thembisa()
TotalHIV_resampled <- read_output("TotalHIV")
mean(TotalHIV$`1985`)
# 259 was closest
mean(TotalHIV$`1986`)
# 100 was closest
mean(TotalHIV$`1987`)
# 997 was closest
mean(TotalHIV$`1988`)
# 777
mean(TotalHIV$`1989`)
# 407
mean(TotalHIV$`1990`)
# 675
mean(TotalHIV$`1991`)
# 26
mean(TotalHIV$`1992`)
# 463
mean(TotalHIV$`1993`)
# 452
mean(TotalHIV$`1994`)
sd(TotalHIV$`1985`)
mean(TotalHIV$`1985`)
sd(TotalHIV$`1985`)
library(dplyr)
library(ggplot2)
library(dplyr)
library(ggplot2)
# Compiles and runs the Thembisa model
run_thembisa <- function(){
system("g++ -std=c++14 THEMBISA.cpp StatFunctions.cpp mersenne.cpp -o thembisa -O2")
system("./thembisa")
}
# Read output from Thembisa and assign column headers
read_output <- function(output_name){
# Import output txt
output_txt <- paste(output_name, "txt", sep = ".")
output <- read.delim(output_txt, header=FALSE, row.names = 1)
names(output)[2:57] <- seq(1985, 2040)
# names(output)[1] <- "Simulation"
output <- output %>% select(-V2)
#t_output <- as.data.frame(t(output))
#output <- as.data.frame(as_tibble(t_output, rownames = "Year"))
#output$Year <- as.numeric(output$Year)
#names(output)[2] <- "Simulation_1"
return(output)
}
# Plots the outputs over time
plot_outputs <- function(output, output_name, title_of_plot) {
ggplot(output, aes(Year, Simulation_1)) +
geom_line() +
theme_bw() +
ggtitle(title_of_plot) +
ylab(as.character(output_name))
}
edit_formatted_data <- function(parameter_name, new_values, starting_year=1985, final_year=2070){
# select parameter using dictionary
parameter <- formatted_data$data[,which(dictionary$name == parameter_name)]
# Edit value
for (i in ((starting_year+1)-1985):((final_year+1)-1985)){
parameter[i] <- new_values
}
# reassign to formatted data
parameter -> formatted_data$data[,which(dictionary$name == parameter_name)]
return(formatted_data)
}
# Read output from Thembisa and assign column headers
read_output <- function(output_name){
# Import output txt
output_txt <- paste(output_name, "txt", sep = ".")
output <- read.delim(output_txt, header=FALSE, row.names = 1)
names(output)[2:57] <- seq(1985, 2040)
# names(output)[1] <- "Simulation"
output <- output %>% select(-V2)
t_output <- as.data.frame(t(output))
output <- as.data.frame(as_tibble(t_output, rownames = "Year"))
output$Year <- as.numeric(output$Year)
names(output)[2] <- "Simulation_1"
return(output)
}
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/support_modify_inputs.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/scripts/modify_rollout.R')
setwd("/Users/stefanrautenbach/Documents/Imperial/Research_project/HIV_EndGame_SA")
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/support_modify_inputs.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/scripts/modify_rollout.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/scripts/modify_rollout.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/scripts/modify_rollout.R')
View(dictionary)
edit_formatted_data("rate_first_test_neg_fem_under_25", new_values = 0.0, starting_year = 2025)
formatted_data <- edit_formatted_data("rate_first_test_neg_fem_under_25", new_values = 0.0, starting_year = 2025)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
plot_outputs("TotalNewHIV", "New HIV cases", "Total new HIV cases per year - baseline")
TotalNewHIV_baseline <- read_output("TotalNewHIV")
TotalNewHIV_baseline <- read_output("THEMBISAv18/TotalNewHIV")
# Import output txt
output_txt <- paste("THEMBISAv18/TotalNewHIV", "txt", sep = ".")
View(TotalNewHIV_baseline)
TotalNewHIV_baseline <- read_output("THEMBISAv18/TotalNewHIV")
output <- read.delim(output_txt, header=FALSE, row.names = 1)
names(output)[2:57] <- seq(1985, 2070)
names(output)[2:87] <- seq(1985, 2070)
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
# names(output)[1] <- "Simulation"
output <- output %>% select(-V2)
t_output <- as.data.frame(t(output))
TotalNewHIV_baseline <- read_output("THEMBISAv18/TotalNewHIV")
View(TotalNewHIV_baseline)
# Changing general testing from 2025 onwards to 0 in 5-year increments
# Baseline with no changes
run_thembisa()
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
# Changing general testing from 2025 onwards to 0 in 5-year increments
# Baseline with no changes
run_thembisa()
TotalNewHIV_baseline <- read_output("THEMBISAv18/TotalNewHIV")
View(TotalNewHIV_baseline)
plot_outputs(TotalNewHIV_baseline, "New HIV cases", "Total new HIV cases per year - baseline")
# Change Rate of 1st-time HIV testing in uninfected females aged 25 to 0 from 2025
formatted_data <- edit_formatted_data("rate_first_test_neg_fem_under_25",
new_values = 0.0, starting_year = 2025)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
# Change Rate of 1st-time HIV testing in uninfected females aged 25 to 0 from 2025
data <- readLines("THEMBISAv18/Rollout_Original.txt")
formatted_data <- format_data(data, dictionary)
formatted_data <- edit_formatted_data("rate_first_test_neg_fem_under_25",
new_values = 0.0, starting_year = 2025)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
run_thembisa()
TotalNewHIV_baseline <- read_output("THEMBISAv18/TotalNewHIV")
TotalNewHIV_2025 <- read_output("THEMBISAv18/TotalNewHIV")
plot_outputs(TotalNewHIV_baseline, "New HIV cases", "Total new HIV cases per year - 2025")
View(formatted_data)
five_years <- seq(2025, 2070, 5)
paste0("Total new HIV case per year", as.character(2025), collapse = "-")
paste0("Total new HIV case per year", as.character(2025), collapse = " ")
paste0("Total new HIV case per year", as.character(2025), sep = " ")
paste("Total new HIV case per year", as.character(2025), sep = " ")
paste("Total new HIV case per year", as.character(2025), sep = "- ")
paste("Total new HIV case per year", as.character(2025), sep = " - ")
paste("TotalNewHIV_", as.character(2025), sep = "")
paste("TotalNewHIV_", as.character(2025), sep = "") <- read_output("THEMBISAv18/TotalNewHIV")
assign(paste("TotalNewHIV_", as.character(2025), sep = ""), read_output("THEMBISAv18/TotalNewHIV"))
assign(paste("TotalNewHIV_", as.character(2030), sep = ""), read_output("THEMBISAv18/TotalNewHIV"))
for (year in five_years){
data <- readLines("THEMBISAv18/Rollout_Original.txt")
formatted_data <- format_data(data, dictionary)
formatted_data <- edit_formatted_data("rate_first_test_neg_fem_under_25",
new_values = 0.0, starting_year = year)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
run_thembisa()
assign(paste("TotalNewHIV_", as.character(year), sep = ""),
read_output("THEMBISAv18/TotalNewHIV"))
plot_title <- paste("Total new HIV case per year", as.character(year), sep = " - ")
plot_outputs(TotalNewHIV_baseline, "New HIV cases", plot_title)
}
View(TotalNewHIV_2025)
View(TotalNewHIV_2030)
for (year in five_years){
data <- readLines("THEMBISAv18/Rollout_Original.txt")
formatted_data <- format_data(data, dictionary)
formatted_data <- edit_formatted_data("rate_first_test_neg_fem_under_25",
new_values = 0.0, starting_year = year)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
run_thembisa()
assign(paste("TotalNewHIV_", as.character(year), sep = ""),
read_output("THEMBISAv18/TotalNewHIV"))
assign(paste("AIDSdeathsAdultMale_", as.character(year), sep = ""),
read_output("THEMBISAv18/AIDSdeathsAdultM"))
assign(paste("AIDSdeathsAdultFemale_", as.character(year), sep = ""),
read_output("THEMBISAv18/AIDSdeathsAdultF"))
assign(paste("LifeYrsLost_", as.character(year), sep = ""),
read_output("THEMBISAv18/LYlostAIDS"))
}
View(plot_outputs)
View(plot_outputs)
plot_outputs(TotalNewHIV_2025, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2025")
plot_outputs(TotalNewHIV_2030, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2030")
plot_outputs(TotalNewHIV_2025, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2025")
plot_outputs(TotalNewHIV_2030, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2030")
plot_outputs(TotalNewHIV_2035, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2035")
plot_outputs(TotalNewHIV_2040, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2040")
plot_outputs(TotalNewHIV_2045, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2045")
plot_outputs(TotalNewHIV_2050, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2050")
plot_outputs(TotalNewHIV_2055, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2055")
plot_outputs(TotalNewHIV_2060, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2060")
plot_outputs(TotalNewHIV_2065, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2065")
plot_outputs(TotalNewHIV_2070, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2070")
paste(TotalNewHIV_, 2025, sep = "")
paste("TotalNewHIV_", 2025, sep = "")
assign(paste("TotalNewHIV_", 2025, sep = ""))
TotalNewHIV_with_interventions <- c(TotalNewHIV_2025, TotalNewHIV_2030)
TotalNewHIV_with_interventions <- c(TotalNewHIV_2025, TotalNewHIV_2030,
TotalNewHIV_2035, TotalNewHIV_2040,
TotalNewHIV_2045, TotalNewHIV_2050
TotalNewHIV_2055, TotalNewHIV_2060,
TotalNewHIV_2065, TotalNewHIV_2070)
TotalNewHIV_with_interventions <- c(TotalNewHIV_2025, TotalNewHIV_2030,
TotalNewHIV_2035, TotalNewHIV_2040,
TotalNewHIV_2045, TotalNewHIV_2050,
TotalNewHIV_2055, TotalNewHIV_2060,
TotalNewHIV_2065, TotalNewHIV_2070)
# make new plots
for (i, year in TotalNewHIV_with_interventions, five_years){
plot_outputs(i, "New Cases of HIV", year)
}
# make new plots
for (i in TotalNewHIV_with_interventions){
for (year in five_years){
plot_outputs(i, "New Cases of HIV", year)
}
}
TotalNewHIV_with_interventions <- list(TotalNewHIV_2025, TotalNewHIV_2030,
TotalNewHIV_2035, TotalNewHIV_2040,
TotalNewHIV_2045, TotalNewHIV_2050,
TotalNewHIV_2055, TotalNewHIV_2060,
TotalNewHIV_2065, TotalNewHIV_2070)
# make new plots
for (i in TotalNewHIV_with_interventions){
for (year in five_years){
plot_outputs(i, "New Cases of HIV", year)
}
}
# make new plots
for (i in length(TotalNewHIV_with_interventions)){
for (year in five_years){
plot_outputs(TotalNewHIV_with_interventions[i], "New Cases of HIV", year)
}
}
TotalNewHIV_with_interventions[1]
class(TotalNewHIV_with_interventions[1])
class(as.data.frame(TotalNewHIV_with_interventions[1]))
# make new plots
for (i in length(TotalNewHIV_with_interventions)){
for (year in five_years){
plot_outputs(as.data.frame(TotalNewHIV_with_interventions[i]), "New Cases of HIV", year)
}
}
plot_outputs(LifeYrsLost_2025, "Life years lost", "Life years lost - reducing testing in 2025")
plot_outputs(LifeYrsLost_2030, "Life years lost", "Life years lost - reducing testing in 2030")
plot_outputs(LifeYrsLost_2035, "Life years lost", "Life years lost - reducing testing in 2035")
plot_outputs(LifeYrsLost_2040, "Life years lost", "Life years lost - reducing testing in 2040")
plot_outputs(LifeYrsLost_2045, "Life years lost", "Life years lost - reducing testing in 2045")
plot_outputs(LifeYrsLost_2050, "Life years lost", "Life years lost - reducing testing in 2050")
plot_outputs(LifeYrsLost_2055, "Life years lost", "Life years lost - reducing testing in 2055")
plot_outputs(LifeYrsLost_2060, "Life years lost", "Life years lost - reducing testing in 2060")
plot_outputs(LifeYrsLost_2065, "Life years lost", "Life years lost - reducing testing in 2065")
plot_outputs(LifeYrsLost_2070, "Life years lost", "Life years lost - reducing testing in 2070")
plot_outputs(AIDSdeathsAdultMale_2025, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2025")
plot_outputs(AIDSdeathsAdultMale_2030, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2030")
plot_outputs(AIDSdeathsAdultMale_2035, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2035")
plot_outputs(AIDSdeathsAdultMale_2040, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2040")
plot_outputs(AIDSdeathsAdultMale_2045, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2045")
plot_outputs(AIDSdeathsAdultMale_2050, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2050")
plot_outputs(AIDSdeathsAdultMale_2055, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2055")
plot_outputs(AIDSdeathsAdultMale_2060, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2060")
plot_outputs(AIDSdeathsAdultMale_2065, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2065")
plot_outputs(AIDSdeathsAdultMale_2070, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2070")
plot_outputs(AIDSdeathsAdultFemale_2025, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2025")
plot_outputs(AIDSdeathsAdultFemale_2030, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2030")
plot_outputs(AIDSdeathsAdultFemale_2035, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2035")
plot_outputs(AIDSdeathsAdultFemale_2040, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2040")
plot_outputs(AIDSdeathsAdultFemale_2045, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2045")
plot_outputs(AIDSdeathsAdultFemale_2050, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2050")
plot_outputs(AIDSdeathsAdultFemale_2055, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2055")
plot_outputs(AIDSdeathsAdultFemale_2060, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2060")
plot_outputs(AIDSdeathsAdultFemale_2065, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2065")
plot_outputs(AIDSdeathsAdultFemale_2070, "AIDS realted deaths", "AIDS related deaths in Adult Males reducing testing in 2070")
plot_outputs(AIDSdeathsAdultFemale_2025, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2025")
plot_outputs(AIDSdeathsAdultFemale_2030, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2030")
plot_outputs(AIDSdeathsAdultFemale_2035, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2035")
plot_outputs(AIDSdeathsAdultFemale_2040, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2040")
plot_outputs(AIDSdeathsAdultFemale_2045, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2045")
plot_outputs(AIDSdeathsAdultFemale_2050, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2050")
plot_outputs(AIDSdeathsAdultFemale_2055, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2055")
plot_outputs(AIDSdeathsAdultFemale_2060, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2060")
plot_outputs(AIDSdeathsAdultFemale_2065, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2065")
plot_outputs(AIDSdeathsAdultFemale_2070, "AIDS realted deaths", "AIDS related deaths in Adult Females reducing testing in 2070")
# Baseline with no changes
data <- readLines("THEMBISAv18/Rollout_Original.txt")
formatted_data <- format_data(data, dictionary)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
run_thembisa()
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction")
plot_outputs(TotalNewHIV_2025, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2025")
plot_outputs(TotalNewHIV_2030, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2030")
plot_outputs(TotalNewHIV_2035, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2035")
plot_outputs(TotalNewHIV_2040, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2040")
plot_outputs(TotalNewHIV_2045, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2045")
plot_outputs(TotalNewHIV_2050, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2050")
plot_outputs(TotalNewHIV_2055, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2055")
plot_outputs(TotalNewHIV_2060, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2060")
plot_outputs(TotalNewHIV_2065, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2065")
plot_outputs(TotalNewHIV_2070, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2070")
# life years lost
plot_outputs(LifeYrsLost_baseline, "Life years lost", "Life years lost - no testing reduction")
plot_outputs(LifeYrsLost_2025, "Life years lost", "Life years lost - reducing testing in 2025")
plot_outputs(LifeYrsLost_2030, "Life years lost", "Life years lost - reducing testing in 2030")
plot_outputs(LifeYrsLost_2035, "Life years lost", "Life years lost - reducing testing in 2035")
plot_outputs(LifeYrsLost_2040, "Life years lost", "Life years lost - reducing testing in 2040")
plot_outputs(LifeYrsLost_2045, "Life years lost", "Life years lost - reducing testing in 2045")
plot_outputs(LifeYrsLost_2050, "Life years lost", "Life years lost - reducing testing in 2050")
plot_outputs(LifeYrsLost_2055, "Life years lost", "Life years lost - reducing testing in 2055")
plot_outputs(LifeYrsLost_2060, "Life years lost", "Life years lost - reducing testing in 2060")
plot_outputs(LifeYrsLost_2065, "Life years lost", "Life years lost - reducing testing in 2065")
plot_outputs(LifeYrsLost_2070, "Life years lost", "Life years lost - reducing testing in 2070")
# AIDS related deaths in Adult Males
plot_outputs(AIDSdeathsAdultMale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Males - no testing reduction")
plot_outputs(AIDSdeathsAdultMale_2025, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2025")
plot_outputs(AIDSdeathsAdultMale_2030, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2030")
plot_outputs(AIDSdeathsAdultMale_2035, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2035")
plot_outputs(AIDSdeathsAdultMale_2040, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2040")
plot_outputs(AIDSdeathsAdultMale_2045, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2045")
plot_outputs(AIDSdeathsAdultMale_2050, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2050")
plot_outputs(AIDSdeathsAdultMale_2055, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2055")
plot_outputs(AIDSdeathsAdultMale_2060, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2060")
plot_outputs(AIDSdeathsAdultMale_2065, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2065")
plot_outputs(AIDSdeathsAdultMale_2070, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2070")
# AIDS related deaths in Adult Females
plot_outputs(AIDSdeathsAdultFemale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Females - no testing reduction")
plot_outputs(AIDSdeathsAdultFemale_2025, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2025")
plot_outputs(AIDSdeathsAdultFemale_2030, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2030")
plot_outputs(AIDSdeathsAdultFemale_2035, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2035")
plot_outputs(AIDSdeathsAdultFemale_2040, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2040")
plot_outputs(AIDSdeathsAdultFemale_2045, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2045")
plot_outputs(AIDSdeathsAdultFemale_2050, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2050")
plot_outputs(AIDSdeathsAdultFemale_2055, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2055")
plot_outputs(AIDSdeathsAdultFemale_2060, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2060")
plot_outputs(AIDSdeathsAdultFemale_2065, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2065")
plot_outputs(AIDSdeathsAdultFemale_2070, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2070")
AIDSdeathsAdultMale_baseline <- read_output("THEMBISAv18/AIDSdeathsAdultM")
AIDSdeathsAdultFemale_baseline <- read_output("THEMBISAv18/AIDSdeathsAdultF")
plot_outputs(AIDSdeathsAdultFemale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Females - no testing reduction")
plot_outputs(AIDSdeathsAdultFemale_2025, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2025")
plot_outputs(AIDSdeathsAdultFemale_2030, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2030")
plot_outputs(AIDSdeathsAdultFemale_2035, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2035")
plot_outputs(AIDSdeathsAdultFemale_2040, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2040")
plot_outputs(AIDSdeathsAdultFemale_2045, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2045")
plot_outputs(AIDSdeathsAdultFemale_2050, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2050")
plot_outputs(AIDSdeathsAdultFemale_2055, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2055")
plot_outputs(AIDSdeathsAdultFemale_2060, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2060")
plot_outputs(AIDSdeathsAdultFemale_2065, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2065")
plot_outputs(AIDSdeathsAdultFemale_2070, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2070")
# Plots the outputs over time
plot_outputs <- function(output, output_name, title_of_plot) {
ggplot(output, aes(Year>=2020, Simulation_1)) +
geom_line() +
theme_bw() +
ggtitle(title_of_plot) +
ylab(as.character(output_name))
}
# make new plots
# new hiv cases
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction")
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
# make new plots
# new hiv cases
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction") + ymin(2020)
# make new plots
# new hiv cases
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction") + ylim(2020)
# make new plots
# new hiv cases
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction") + ylim(2020, 2070)
# make new plots
# new hiv cases
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_baseline, "New Cases of HIV", "Annual new HIV cases - no testing reduction") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2025, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2025") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2030, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2030") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2035, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2035") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2040, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2040") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2045, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2045") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2050, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2050") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2055, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2055") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2060, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2060") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2065, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2065") + xlim(2020, 2070)
plot_outputs(TotalNewHIV_2070, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2070") + xlim(2020, 2070)
# life years lost
plot_outputs(LifeYrsLost_baseline, "Life years lost", "Life years lost - no testing reduction") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2025, "Life years lost", "Life years lost - reducing testing in 2025") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2030, "Life years lost", "Life years lost - reducing testing in 2030") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2035, "Life years lost", "Life years lost - reducing testing in 2035") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2040, "Life years lost", "Life years lost - reducing testing in 2040") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2045, "Life years lost", "Life years lost - reducing testing in 2045") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2050, "Life years lost", "Life years lost - reducing testing in 2050") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2055, "Life years lost", "Life years lost - reducing testing in 2055") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2060, "Life years lost", "Life years lost - reducing testing in 2060") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2065, "Life years lost", "Life years lost - reducing testing in 2065") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2070, "Life years lost", "Life years lost - reducing testing in 2070") + xlim(2020, 2070)
# AIDS related deaths in Adult Males
plot_outputs(AIDSdeathsAdultMale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Males - no testing reduction") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2025, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2025") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2030, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2030") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2035, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2035") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2040, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2040") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2045, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2045") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2050, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2050") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2055, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2055") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2060, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2060") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2065, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2065") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultMale_2070, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2070") + xlim(2020, 2070)
# AIDS related deaths in Adult Females
plot_outputs(AIDSdeathsAdultFemale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Females - no testing reduction") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2025, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2025") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2030, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2030") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2035, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2035") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2040, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2040") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2045, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2045") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2050, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2050") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2055, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2055") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2060, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2060") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2065, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2065") + xlim(2020, 2070)
plot_outputs(AIDSdeathsAdultFemale_2070, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2070") + xlim(2020, 2070)
LifeYrsLost_baseline <- read_output("THEMBISAv18/LYlostAIDS")
# life years lost
plot_outputs(LifeYrsLost_baseline, "Life years lost", "Life years lost - no testing reduction") + xlim(2020, 2070)
View(TotalNewHIV_2025)
View(TotalNewHIV_baseline)
five_years <- 2025
for (year in five_years){
data <- readLines("THEMBISAv18/Rollout_Original.txt")
formatted_data <- format_data(data, dictionary)
formatted_data <- edit_formatted_data("rate_first_test_neg_fem_under_25",
new_values = 0.0, starting_year = year)
rollout <- convert_to_thembisa_format(formatted_data, data, dictionary)
write(rollout, "THEMBISAv18/Rollout.txt")
run_thembisa()
assign(paste("TotalNewHIV_", as.character(year), sep = ""),
read_output("THEMBISAv18/TotalNewHIV"))
assign(paste("AIDSdeathsAdultMale_", as.character(year), sep = ""),
read_output("THEMBISAv18/AIDSdeathsAdultM"))
assign(paste("AIDSdeathsAdultFemale_", as.character(year), sep = ""),
read_output("THEMBISAv18/AIDSdeathsAdultF"))
assign(paste("LifeYrsLost_", as.character(year), sep = ""),
read_output("THEMBISAv18/LYlostAIDS"))
}
plot_outputs(TotalNewHIV_2025, "New Cases of HIV", "Annual new HIV cases - reducing testing in 2025") + xlim(2020, 2070)
five_years <- seq(2025, 2070, 5)
# AIDS related deaths in Adult Females
plot_outputs(AIDSdeathsAdultFemale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Females - no testing reduction") + xlim(2020, 2070) + ylim(0, 30000)
# AIDS related deaths in Adult Females
plot_outputs(AIDSdeathsAdultFemale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Females - no testing reduction") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2025, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2025") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2030, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2030") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2035, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2035") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2040, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2040") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2045, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2045") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2050, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2050") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2055, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2055") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2060, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2060") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2065, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2065") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultFemale_2070, "AIDS related deaths", "AIDS related deaths in Adult Females reducing testing in 2070") + xlim(2020, 2070) + ylim(0, 30000)
# life years lost
plot_outputs(LifeYrsLost_baseline, "Life years lost", "Life years lost - no testing reduction") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2025, "Life years lost", "Life years lost - reducing testing in 2025") + xlim(2020, 2070)
plot_outputs(LifeYrsLost_2030, "Life years lost", "Life years lost - reducing testing in 2030") + xlim(2020, 2070)
# life years lost
plot_outputs(LifeYrsLost_baseline, "Life years lost", "Life years lost - no testing reduction") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2025, "Life years lost", "Life years lost - reducing testing in 2025") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2030, "Life years lost", "Life years lost - reducing testing in 2030") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2035, "Life years lost", "Life years lost - reducing testing in 2035") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2040, "Life years lost", "Life years lost - reducing testing in 2040") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2045, "Life years lost", "Life years lost - reducing testing in 2045") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2050, "Life years lost", "Life years lost - reducing testing in 2050") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2055, "Life years lost", "Life years lost - reducing testing in 2055") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2060, "Life years lost", "Life years lost - reducing testing in 2060") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2065, "Life years lost", "Life years lost - reducing testing in 2065") + xlim(2020, 2070) + ylim(0, 2.5e+6)
plot_outputs(LifeYrsLost_2070, "Life years lost", "Life years lost - reducing testing in 2070") + xlim(2020, 2070) + ylim(0, 2.5e+6)
# AIDS related deaths in Adult Males
plot_outputs(AIDSdeathsAdultMale_baseline, "AIDS related deaths", "AIDS related deaths in Adult Males - no testing reduction") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2025, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2025") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2030, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2030") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2035, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2035") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2040, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2040") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2045, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2045") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2050, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2050") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2055, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2055") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2060, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2060") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2065, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2065") + xlim(2020, 2070) + ylim(0, 30000)
plot_outputs(AIDSdeathsAdultMale_2070, "AIDS related deaths", "AIDS related deaths in Adult Males reducing testing in 2070") + xlim(2020, 2070) + ylim(0, 30000)
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/support_modify_inputs.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/support_modify_inputs.R')
source('~/Documents/Imperial/Research_project/HIV_EndGame_SA/R/functions_01Jun.R')

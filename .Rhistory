condom_incr_years <- condom_incr_years
condom_maintenance_years <- condom_maintenance_years
one_scenario <- run_thembisa_scenario_prev_year(pitc_reduction_year = pitc_reduction_year,
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = fsw_condom_usage_decrease,
st_condom_usage_decrease = st_condom_usage_decrease,
lt_condom_usage_decrease = lt_condom_usage_decrease,
condom_incr_years = condom_incr_years,
condom_maintenance_years = condom_maintenance_years,
art_interrupt_rate_decrease = art_interrupt_rate_decrease,
art_incr_years = art_incr_years,
art_coverage_increase = FALSE,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
name <- paste(year, percentage_value, sep = "_")
scenarios[which(scenario_names == name)] <- one_scenario # save df for one scenario
}
}
View(summary)
View(scenarios)
scenarios[[1]]
scenarios[[which(scenario_names == name)]] <- one_scenario # save df for one scenario
# for loop that changes testing rate at different years and saves outputs
for (percentage_value in pitc_reduction_percentage){
fsw_condom_usage_decrease <- fsw_condom_usage_decrease
st_condom_usage_decrease <- st_condom_usage_decrease
lt_condom_usage_decrease <- lt_condom_usage_decrease
base_rate_reduction <- percentage_value/100
for (year in pitc_reduction_years){
pitc_reduction_year <- year
condom_incr_years <- condom_incr_years
condom_maintenance_years <- condom_maintenance_years
one_scenario <- run_thembisa_scenario_prev_year(pitc_reduction_year = pitc_reduction_year,
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = fsw_condom_usage_decrease,
st_condom_usage_decrease = st_condom_usage_decrease,
lt_condom_usage_decrease = lt_condom_usage_decrease,
condom_incr_years = condom_incr_years,
condom_maintenance_years = condom_maintenance_years,
art_interrupt_rate_decrease = art_interrupt_rate_decrease,
art_incr_years = art_incr_years,
art_coverage_increase = FALSE,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
name <- paste(year, percentage_value, sep = "_")
scenarios[[which(scenario_names == name)]] <- one_scenario # save df for one scenario
}
}
View(scenarios)
View(scenarios[[1]])
run_on_cluster <- function(pitc_reduction_years, pitc_reduction_percentage,
condom_usage_reduction = FALSE,
fsw_condom_usage_decrease, st_condom_usage_decrease, lt_condom_usage_decrease,
condom_incr_years, condom_maintenance_years,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease, art_incr_years,
cumulative_years){
#### Load packages/functions ####
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(here)
library(purrr)
source(here("scripts/modify_rollout.R"))
source(here("R/read_and_run.R"))
#### Make empty dataframe for outputs ####
# names of all the outputs of interest
output_names <- c("TotalHIVtests", "NewAdultHIV",
"AIDSdeathsAdultM", "AIDSdeathsAdultF", "TotSexActs",
"SWsexActs", "TotProtSexActs", "SWsexActsProt", "HIVinc15to49",
"ARTcoverageAdult")
# create empty folder for results
dir.create("results", FALSE, TRUE)
# model input parameters
pitc_reduction_years <- pitc_reduction_years # establish years PITC changes occur
pitc_reduction_percentage <- pitc_reduction_percentage # percentages of pitc that is reduced
condom_usage_reduction <- condom_usage_reduction
fsw_condom_usage_decrease <- fsw_condom_usage_decrease # proportion of previous year's probability that fsw condom usage probability decreases by each year
st_condom_usage_decrease <- st_condom_usage_decrease # proportion of previous year's probability that st condom usage probability decreases by each year
lt_condom_usage_decrease <- lt_condom_usage_decrease # proportion of previous year's probability that lt condom usage probability decreases by each year
condom_incr_years <- condom_incr_years # years for which condom usage probabilities are decreased
condom_maintenance_years <- condom_maintenance_years # years reduced condom usage probabilities are maintained after reduction
art_coverage_increase <- art_coverage_increase
art_interrupt_rate_decrease <- art_interrupt_rate_decrease # proportion of previous year's rate that art interruption rate decreases by each year
art_incr_years <- art_incr_years # years for which art interruption rate decreases
cumulative_years <- cumulative_years # number of years over which cumulative values are calculated
# run baseline model
baseline <- run_thembisa_scenario_prev_year(pitc_reduction_year = NA,
condom_usage_reduction <- FALSE,
fsw_condom_usage_decrease <- 0,
st_condom_usage_decrease <- 0,
lt_condom_usage_decrease <- 0,
condom_incr_years <- NA,
condom_maintenance_years <- condom_maintenance_years,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = NA,
art_incr_years = art_incr_years,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
# save baseline outputs
assign(paste0("baseline","_baseline"), baseline)
n_scenarios <- length(pitc_reduction_percentage) * length(pitc_reduction_years)
scenarios <- replicate(n_scenarios, data_frame())
x <- expand_grid(pitc_reduction_years, pitc_reduction_percentage)
scenario_names <- purrr::pmap_chr(x, paste, sep = "_")
# for loop that changes testing rate at different years and saves outputs
for (percentage_value in pitc_reduction_percentage){
fsw_condom_usage_decrease <- fsw_condom_usage_decrease
st_condom_usage_decrease <- st_condom_usage_decrease
lt_condom_usage_decrease <- lt_condom_usage_decrease
base_rate_reduction <- percentage_value/100
for (year in pitc_reduction_years){
pitc_reduction_year <- year
condom_incr_years <- condom_incr_years
condom_maintenance_years <- condom_maintenance_years
one_scenario <- run_thembisa_scenario_prev_year(pitc_reduction_year = pitc_reduction_year,
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = fsw_condom_usage_decrease,
st_condom_usage_decrease = st_condom_usage_decrease,
lt_condom_usage_decrease = lt_condom_usage_decrease,
condom_incr_years = condom_incr_years,
condom_maintenance_years = condom_maintenance_years,
art_interrupt_rate_decrease = art_interrupt_rate_decrease,
art_incr_years = art_incr_years,
art_coverage_increase = FALSE,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
name <- paste(year, percentage_value, sep = "_")
scenarios[[which(scenario_names == name)]] <- one_scenario # save df for one scenario
}
}
return(scenarios)
#
#
# # make a new data frame joining all results
# df <- read_thembisa_results_cluster(pitc_reduction_years, pitc_reduction_percentage)
#
# # calculate total aids-related deaths
#
# df <- df %>%
#   pivot_wider(names_from = indicator) %>%
#   mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
#   pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
#
# # calculate condom usage for total adults and fsw-client only
# df <- df %>%
#   pivot_wider(names_from = indicator) %>%
#   mutate(CondomUsage = ((TotProtSexActs/TotSexActs)*100)) %>%
#   mutate(FSWCondomUsage = ((SWsexActsProt/SWsexActs)*100)) %>%
#   pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
#
# df$test_reduction <- 100 - as.integer(df$test_reduction)
#
# # make test_reduction a factor
# df$test_reduction <- as.factor(df$test_reduction)
#
# # saving a summary csv of all outputs
# summary <- df %>% filter(
#   scenario == "intervention",
#   year >= 2020) %>%
#   group_by(year, indicator, pitc_reduction_year, test_reduction) %>%
#   summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
#             lower_CI = quantile(value, probs = 0.025))
#
# write_csv(summary, "summary.csv")
#
# # cumulative values
# cumulative_years <- cumulative_years
# cumulative_values <- calc_all_cumulatives(pitc_reduction_years, cumulative_years)
#
# # calculate cumulative percent change from baseline
#
# cumulative_values <- cumulative_values %>%
#   pivot_wider(names_from = scenario, values_from = cumulative) %>%
#   mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
#   mutate(absolute_dif = intervention - baseline) %>%
#   pivot_longer(-(indicator:test_reduction), names_to = "scenario")
#
# # Plotting cumulative HIV infections over 40 year
# cumulative_summary <- cumulative_values %>%
#   group_by(indicator, pitc_reduction_year, test_reduction, scenario) %>%
#   summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
#             lower_CI = quantile(value, probs = 0.025))
#
# write_csv(cumulative_summary, "cumulative_summary.csv")
}
run_on_cluster(pitc_reduction_years = c(2035),
pitc_reduction_percentage = seq(0,100,100),
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = 0.0475,
st_condom_usage_decrease = 0.014,
lt_condom_usage_decrease = 0.014,
condom_incr_years = seq(2035, 2035+10, 1),
condom_maintenance_years = seq(2035+11, 2100, 1),
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = NA,
art_incr_years = NA,
cumulative_years <- 50
)
names(scenarios) <- scenario_names
scenario_names
scenarios
bind_rows(scenarios, .id = "pitc_reduction_year") %>%
dplyr::rename(intervention = value) %>%
dplyr::left_join(baseline) %>%
dplyr::rename(baseline = value) %>%
separate(pitc_reduction_year, c("pitc_reduction_year", "test_reduction")) %>%
tidyr::pivot_longer(c(intervention, baseline), names_to = "scenario")
read_thembisa_results_cluster <- function(pitc_reduction_years, pitc_reduction_percentage){
names(scenarios) <- scenario_names
bind_rows(scenarios, .id = "pitc_reduction_year") %>%
dplyr::rename(intervention = value) %>%
dplyr::left_join(baseline) %>%
dplyr::rename(baseline = value) %>%
separate(pitc_reduction_year, c("pitc_reduction_year", "test_reduction")) %>%
tidyr::pivot_longer(c(intervention, baseline), names_to = "scenario")
}
# make a new data frame joining all results
df <- read_thembisa_results_cluster(pitc_reduction_years, pitc_reduction_percentage)
View(df)
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
# calculate condom usage for total adults and fsw-client only
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(CondomUsage = ((TotProtSexActs/TotSexActs)*100)) %>%
mutate(FSWCondomUsage = ((SWsexActsProt/SWsexActs)*100)) %>%
pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
df$test_reduction <- 100 - as.integer(df$test_reduction)
# make test_reduction a factor
df$test_reduction <- as.factor(df$test_reduction)
# saving a summary csv of all outputs
summary <- df %>% filter(
scenario == "intervention",
year >= 2020) %>%
group_by(year, indicator, pitc_reduction_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025))
run_on_cluster <- function(pitc_reduction_years, pitc_reduction_percentage,
condom_usage_reduction = FALSE,
fsw_condom_usage_decrease, st_condom_usage_decrease, lt_condom_usage_decrease,
condom_incr_years, condom_maintenance_years,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease, art_incr_years,
cumulative_years){
#### Load packages/functions ####
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(here)
library(purrr)
source(here("scripts/modify_rollout.R"))
source(here("R/read_and_run.R"))
#### Make empty dataframe for outputs ####
# names of all the outputs of interest
output_names <- c("TotalHIVtests", "NewAdultHIV",
"AIDSdeathsAdultM", "AIDSdeathsAdultF", "TotSexActs",
"SWsexActs", "TotProtSexActs", "SWsexActsProt", "HIVinc15to49",
"ARTcoverageAdult")
# create empty folder for results
dir.create("results", FALSE, TRUE)
# model input parameters
pitc_reduction_years <- pitc_reduction_years # establish years PITC changes occur
pitc_reduction_percentage <- pitc_reduction_percentage # percentages of pitc that is reduced
condom_usage_reduction <- condom_usage_reduction
fsw_condom_usage_decrease <- fsw_condom_usage_decrease # proportion of previous year's probability that fsw condom usage probability decreases by each year
st_condom_usage_decrease <- st_condom_usage_decrease # proportion of previous year's probability that st condom usage probability decreases by each year
lt_condom_usage_decrease <- lt_condom_usage_decrease # proportion of previous year's probability that lt condom usage probability decreases by each year
condom_incr_years <- condom_incr_years # years for which condom usage probabilities are decreased
condom_maintenance_years <- condom_maintenance_years # years reduced condom usage probabilities are maintained after reduction
art_coverage_increase <- art_coverage_increase
art_interrupt_rate_decrease <- art_interrupt_rate_decrease # proportion of previous year's rate that art interruption rate decreases by each year
art_incr_years <- art_incr_years # years for which art interruption rate decreases
cumulative_years <- cumulative_years # number of years over which cumulative values are calculated
# run baseline model
baseline <- run_thembisa_scenario_prev_year(pitc_reduction_year = NA,
condom_usage_reduction <- FALSE,
fsw_condom_usage_decrease <- 0,
st_condom_usage_decrease <- 0,
lt_condom_usage_decrease <- 0,
condom_incr_years <- NA,
condom_maintenance_years <- condom_maintenance_years,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = NA,
art_incr_years = art_incr_years,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
# save baseline outputs
assign(paste0("baseline","_baseline"), baseline)
n_scenarios <- length(pitc_reduction_percentage) * length(pitc_reduction_years)
scenarios <- replicate(n_scenarios, data_frame())
x <- expand_grid(pitc_reduction_years, pitc_reduction_percentage)
scenario_names <- purrr::pmap_chr(x, paste, sep = "_")
# for loop that changes testing rate at different years and saves outputs
for (percentage_value in pitc_reduction_percentage){
fsw_condom_usage_decrease <- fsw_condom_usage_decrease
st_condom_usage_decrease <- st_condom_usage_decrease
lt_condom_usage_decrease <- lt_condom_usage_decrease
base_rate_reduction <- percentage_value/100
for (year in pitc_reduction_years){
pitc_reduction_year <- year
condom_incr_years <- condom_incr_years
condom_maintenance_years <- condom_maintenance_years
one_scenario <- run_thembisa_scenario_prev_year(pitc_reduction_year = pitc_reduction_year,
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = fsw_condom_usage_decrease,
st_condom_usage_decrease = st_condom_usage_decrease,
lt_condom_usage_decrease = lt_condom_usage_decrease,
condom_incr_years = condom_incr_years,
condom_maintenance_years = condom_maintenance_years,
art_interrupt_rate_decrease = art_interrupt_rate_decrease,
art_incr_years = art_incr_years,
art_coverage_increase = FALSE,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
name <- paste(year, percentage_value, sep = "_")
scenarios[[which(scenario_names == name)]] <- one_scenario # save df for one scenario
}
}
# make a new data frame joining all results
df <- read_thembisa_results_cluster(pitc_reduction_years, pitc_reduction_percentage)
# calculate total aids-related deaths
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
# calculate condom usage for total adults and fsw-client only
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(CondomUsage = ((TotProtSexActs/TotSexActs)*100)) %>%
mutate(FSWCondomUsage = ((SWsexActsProt/SWsexActs)*100)) %>%
pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
df$test_reduction <- 100 - as.integer(df$test_reduction)
# make test_reduction a factor
df$test_reduction <- as.factor(df$test_reduction)
# saving a summary csv of all outputs
summary <- df %>% filter(
scenario == "intervention",
year >= 2020) %>%
group_by(year, indicator, pitc_reduction_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025))
write_csv(summary, "summary.csv")
# cumulative values
cumulative_years <- cumulative_years
cumulative_values <- calc_all_cumulatives(pitc_reduction_years, cumulative_years)
# calculate cumulative percent change from baseline
cumulative_values <- cumulative_values %>%
pivot_wider(names_from = scenario, values_from = cumulative) %>%
mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
mutate(absolute_dif = intervention - baseline) %>%
pivot_longer(-(indicator:test_reduction), names_to = "scenario")
# Plotting cumulative HIV infections over 40 year
cumulative_summary <- cumulative_values %>%
group_by(indicator, pitc_reduction_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025))
write_csv(cumulative_summary, "cumulative_summary.csv")
}
run_on_cluster(pitc_reduction_years = c(2025, 2099),
pitc_reduction_percentage = seq(0,100,100),
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = 0.0475,
st_condom_usage_decrease = 0.014,
lt_condom_usage_decrease = 0.014,
condom_incr_years = seq(2035, 2035+10, 1),
condom_maintenance_years = seq(2035+11, 2100, 1),
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = NA,
art_incr_years = NA,
cumulative_years <- 50
)
run_on_cluster <- function(pitc_reduction_years, pitc_reduction_percentage,
condom_usage_reduction = FALSE,
fsw_condom_usage_decrease, st_condom_usage_decrease, lt_condom_usage_decrease,
condom_incr_years, condom_maintenance_years,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease, art_incr_years,
cumulative_years){
#### Load packages/functions ####
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(here)
library(purrr)
source(here("scripts/modify_rollout.R"))
source(here("R/read_and_run.R"))
#### Make empty dataframe for outputs ####
# names of all the outputs of interest
output_names <- c("TotalHIVtests", "NewAdultHIV",
"AIDSdeathsAdultM", "AIDSdeathsAdultF", "TotSexActs",
"SWsexActs", "TotProtSexActs", "SWsexActsProt", "HIVinc15to49",
"ARTcoverageAdult")
# create empty folder for results
dir.create("results", FALSE, TRUE)
# model input parameters
pitc_reduction_years <- pitc_reduction_years # establish years PITC changes occur
pitc_reduction_percentage <- pitc_reduction_percentage # percentages of pitc that is reduced
condom_usage_reduction <- condom_usage_reduction
fsw_condom_usage_decrease <- fsw_condom_usage_decrease # proportion of previous year's probability that fsw condom usage probability decreases by each year
st_condom_usage_decrease <- st_condom_usage_decrease # proportion of previous year's probability that st condom usage probability decreases by each year
lt_condom_usage_decrease <- lt_condom_usage_decrease # proportion of previous year's probability that lt condom usage probability decreases by each year
condom_incr_years <- condom_incr_years # years for which condom usage probabilities are decreased
condom_maintenance_years <- condom_maintenance_years # years reduced condom usage probabilities are maintained after reduction
art_coverage_increase <- art_coverage_increase
art_interrupt_rate_decrease <- art_interrupt_rate_decrease # proportion of previous year's rate that art interruption rate decreases by each year
art_incr_years <- art_incr_years # years for which art interruption rate decreases
cumulative_years <- cumulative_years # number of years over which cumulative values are calculated
# run baseline model
baseline <- run_thembisa_scenario_prev_year(pitc_reduction_year = NA,
condom_usage_reduction <- FALSE,
fsw_condom_usage_decrease <- 0,
st_condom_usage_decrease <- 0,
lt_condom_usage_decrease <- 0,
condom_incr_years <- NA,
condom_maintenance_years <- condom_maintenance_years,
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = NA,
art_incr_years = art_incr_years,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
# save baseline outputs
assign(paste0("baseline","_baseline"), baseline)
n_scenarios <- length(pitc_reduction_percentage) * length(pitc_reduction_years)
scenarios <- replicate(n_scenarios, data_frame())
x <- expand_grid(pitc_reduction_years, pitc_reduction_percentage)
scenario_names <- purrr::pmap_chr(x, paste, sep = "_")
# for loop that changes testing rate at different years and saves outputs
for (percentage_value in pitc_reduction_percentage){
fsw_condom_usage_decrease <- fsw_condom_usage_decrease
st_condom_usage_decrease <- st_condom_usage_decrease
lt_condom_usage_decrease <- lt_condom_usage_decrease
base_rate_reduction <- percentage_value/100
for (year in pitc_reduction_years){
pitc_reduction_year <- year
condom_incr_years <- condom_incr_years
condom_maintenance_years <- condom_maintenance_years
one_scenario <- run_thembisa_scenario_prev_year(pitc_reduction_year = pitc_reduction_year,
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = fsw_condom_usage_decrease,
st_condom_usage_decrease = st_condom_usage_decrease,
lt_condom_usage_decrease = lt_condom_usage_decrease,
condom_incr_years = condom_incr_years,
condom_maintenance_years = condom_maintenance_years,
art_interrupt_rate_decrease = art_interrupt_rate_decrease,
art_incr_years = art_incr_years,
art_coverage_increase = FALSE,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
name <- paste(year, percentage_value, sep = "_")
scenarios[[which(scenario_names == name)]] <- one_scenario # save df for one scenario
}
}
# make a new data frame joining all results
df <- read_thembisa_results_cluster(pitc_reduction_years, pitc_reduction_percentage)
# calculate total aids-related deaths
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
# calculate condom usage for total adults and fsw-client only
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(CondomUsage = ((TotProtSexActs/TotSexActs)*100)) %>%
mutate(FSWCondomUsage = ((SWsexActsProt/SWsexActs)*100)) %>%
pivot_longer(-(pitc_reduction_year:scenario), names_to = "indicator")
df$test_reduction <- 100 - as.integer(df$test_reduction)
# make test_reduction a factor
df$test_reduction <- as.factor(df$test_reduction)
# saving a summary csv of all outputs
summary <- df %>% filter(
scenario == "intervention",
year >= 2020) %>%
group_by(year, indicator, pitc_reduction_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025))
write_csv(summary, "results/summary.csv")
# cumulative values
cumulative_years <- cumulative_years
cumulative_values <- calc_all_cumulatives(pitc_reduction_years, cumulative_years)
# calculate cumulative percent change from baseline
cumulative_values <- cumulative_values %>%
pivot_wider(names_from = scenario, values_from = cumulative) %>%
mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
mutate(absolute_dif = intervention - baseline) %>%
pivot_longer(-(indicator:test_reduction), names_to = "scenario")
# Plotting cumulative HIV infections over 40 year
cumulative_summary <- cumulative_values %>%
group_by(indicator, pitc_reduction_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025))
write_csv(cumulative_summary, "results/cumulative_summary.csv")
}
run_on_cluster(pitc_reduction_years = c(2025, 2099),
pitc_reduction_percentage = seq(0,100,100),
condom_usage_reduction = TRUE,
fsw_condom_usage_decrease = 0.0475,
st_condom_usage_decrease = 0.014,
lt_condom_usage_decrease = 0.014,
condom_incr_years = seq(2035, 2035+10, 1),
condom_maintenance_years = seq(2035+11, 2100, 1),
art_coverage_increase = FALSE,
art_interrupt_rate_decrease = NA,
art_incr_years = NA,
cumulative_years <- 50
)
source("~/Documents/HIV_EndGame_SA/R/read_and_run.R")

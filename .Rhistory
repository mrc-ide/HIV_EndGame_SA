legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4a
fig4b
fig4c
fig4d
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "white",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "white",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "white",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "white",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4ac <- ggarrange(fig4c, fig4a, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4d, fig4b, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "navyblue",
mid = "white",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif", art_ret_rate > 0.36) %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
art_ret_rate > 0.36) %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif") %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
overall_condom_usage > 16) %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
overall_condom_usage > 16) %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif", art_ret_rate > 0.36) %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
art_ret_rate > 0.36) %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
overall_condom_usage > 16) %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
overall_condom_usage > 16) %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_raster(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)
fig4a <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif", art_ret_rate > 0.36) %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4b <- cumulative_art_change %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
art_ret_rate > 0.36) %>%
ggplot(aes(test_reduction, art_ret_rate, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 1-0.22), lty = "dotted") +
annotate(geom = "text", x=50, y=0.78, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Female ART retention rate") +
scale_y_continuous(name ="Female ART retention (%)",
breaks = c(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.78, 0.8, 0.9),
labels = c("10", "20", "30", "40","50", "60", "70","", "80", "90"),
trans = "logit") +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4c <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "NewAdultHIV",
scenario == "absolute_dif",
overall_condom_usage > 16) %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nHIV infections"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nHIV \ninfections \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4d <- condom_change_cumulative %>%
mutate(pitc_reduction_year = as.factor(pitc_reduction_year)) %>%
filter(indicator == "TotalAIDSdeathsadult",
scenario == "absolute_dif",
overall_condom_usage > 16) %>%
ggplot(aes(test_reduction, overall_condom_usage, z = mean/10**6)) +
with_blur(sigma = 5,
geom_tile(aes(fill = mean/10**6), interpolate = TRUE)) +
geom_contour(aes(color = "No additional \nAIDS-related \ndeaths"),breaks = 0,show.legend = FALSE) +
geom_text_contour(stroke = 0.1, stroke.colour = "white",check_overlap = TRUE, breaks = 0) +
geom_hline(aes(yintercept = 33), lty = "dotted") +
annotate(geom = "text", x=50, y=33, label="Baseline", parse = TRUE) +
scale_fill_gradient2("Additional \nAIDS-related \ndeaths \n(millions)",
low = "blue",
mid = "lightyellow",
high = "red",
midpoint = 0) +
ylab("Overall condom usage (%)") + scale_y_continuous(trans = "log", breaks = c(10, 15, 20, 25, 30, 33, 35, 40, 45, 50, 55), labels = c("10", "15", "20","25", "30", "", 35, "40", "45", "50", "55")) +
xlab("Testing reduction (%)") + theme_classic() + theme(axis.text = element_text(size = 11),
axis.title.y = element_text(size = 11),
axis.title.x = element_text(size = 11),
legend.text = element_text(size = 11)) +
scale_color_discrete("",type = "black")
fig4ac <- ggarrange(fig4a, fig4c, nrow = 2, common.legend = TRUE, legend = "right", labels = c("A","C"))
fig4bd <- ggarrange(fig4b, fig4d, nrow = 2, common.legend = TRUE, legend = "right", labels = c("B","D"))
ggarrange(fig4ac, fig4bd, ncol = 2)

color = "black", face = "bold", size = 15))
ggsave(filename = "figures/suppfig22.png", plot = suppfig22, device = "png", width = 20, height = 29, units = "cm")
ggsave(filename = "figures/suppfig22.pdf", plot = suppfig22, device = "pdf", width = 20, height = 29, units = "cm")
suppfig23<- ggarrange(fig4c, suppfig16c, suppfig17c, suppfig18c, suppfig19c, suppfig20c, nrow = 3, ncol = 2, legend = "right", labels = "AUTO", common.legend = TRUE)
suppfig23 <- annotate_figure(suppfig23, top = text_grob("Additional HIV infections (millions)",
color = "black", face = "bold", size = 15))
suppfig23
ggsave(filename = "figures/suppfig23.png", plot = suppfig23, device = "png", width = 20, height = 29, units = "cm")
suppfig24<- ggarrange(fig4d, suppfig16d, suppfig17d, suppfig18d, suppfig19d, suppfig20d, nrow = 3, ncol = 2, legend = "right", labels = "AUTO", common.legend = TRUE)
suppfig24 <- annotate_figure(suppfig24, top = text_grob("Additional AIDS deaths (millions)",
color = "black", face = "bold", size = 15))
suppfig24
ggsave(filename = "figures/suppfig24.pdf", plot = suppfig24, device = "pdf", width = 20, height = 29, units = "cm")
ggsave(filename = "figures/suppfig24.png", plot = suppfig24, device = "png", width = 20, height = 29, units = "cm")
suppfig10 <- ggarrange(suppfig10a, suppfig10b, suppfig10c, suppfig10d, ncol = 2, nrow = 2, common.legend = TRUE, legend = "right", labels = "AUTO")
suppfig10
suppfig10d <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
future_value %in% c(0, 1, 3, 5, 7, 9, 11, 13, 14)
) %>% mutate(overall_condom_usage = as.factor(round(overall_condom_usage,0))) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual condom usage \nwith different condom usage (%) in 2035") +
scale_y_continuous("Condom usage (%) \n (15+ years) \n") +
scale_colour_discrete() +
theme(legend.title = element_blank())
suppfig10c <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>% mutate(overall_condom_usage = as.factor(round(overall_condom_usage,0))) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual ART coverage \nwith different condom usage (%) in 2035") +
scale_y_continuous("ART coverage (%) \n(15+ years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_colour_discrete() +
theme(legend.title = element_blank())
suppfig10c <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>% mutate(overall_condom_usage = as.factor(round(overall_condom_usage,0))) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual ART coverage \nwith different condom usage (%) in 2035") +
scale_y_continuous("ART coverage (%) \n(15+ years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10d <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>% mutate(overall_condom_usage = as.factor(round(overall_condom_usage,0))) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual condom usage \nwith different condom usage (%) in 2035") +
scale_y_continuous("Condom usage (%) \n (15+ years) \n") +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10 <- ggarrange(suppfig10a, suppfig10b, suppfig10c, suppfig10d, ncol = 2, nrow = 2, common.legend = TRUE, legend = "right", labels = "AUTO")
suppfig10c <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual ART coverage \nwith different condom usage (%) in 2035") +
scale_y_continuous("ART coverage (%) \n(15+ years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10d <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual condom usage \nwith different condom usage (%) in 2035") +
scale_y_continuous("Condom usage (%) \n (15+ years) \n") +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10 <- ggarrange(suppfig10a, suppfig10b, suppfig10c, suppfig10d, ncol = 2, nrow = 2, common.legend = TRUE, legend = "right", labels = "AUTO")
suppfig10d
suppfig10b
suppfig10c
suppfig10c <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual ART coverage \nwith different condom usage (%) in 2035") +
scale_y_continuous("ART coverage (%) \n(15+ years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10c
condom_change_summary <- condom_change_summary %>% mutate(overall_condom_usage = as.factor(overall_condom_usage))
condom_change_summary <- condom_change_summary %>% mutate(overall_condom_usage = as.factor(overall_condom_usage))
suppfig10a <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "HIVinc15to49",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_hline(aes(yintercept = 0.001), lty = "dotted") +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "HIVinc15to49",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "HIVinc15to49",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5),
legend.title = element_text(size = 12)) +
ggtitle("HIV incidence") +
scale_y_continuous("HIV incidence per 1000 \n(15-49 years)\n", labels =(function(l) {round(l*1e3,1)}), breaks = c(0, 0.001, 0.002, 0.003, 0.004, 0.005, 0.006, 0.007)) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10b <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "Prev15to49",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "Prev15to49",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "Prev15to49",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("HIV prevalence") +
scale_y_continuous("HIV prevalence (%) \n(15-49 years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10c <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual ART coverage \nwith different condom usage (%) in 2035") +
scale_y_continuous("ART coverage (%) \n(15+ years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10d <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual condom usage \nwith different condom usage (%) in 2035") +
scale_y_continuous("Condom usage (%) \n (15+ years) \n") +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10 <- ggarrange(suppfig10a, suppfig10b, suppfig10c, suppfig10d, ncol = 2, nrow = 2, common.legend = TRUE, legend = "right", labels = "AUTO")
suppfig10
suppfig10
suppfig10d <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "CondomUsage",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual condom usage") +
scale_y_continuous("Condom usage (%) \n (15+ years) \n") +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10c <- condom_change_summary %>%
filter(scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(14.1, 20.4, 27.6, 42.4, 50.3, 58.2)
) %>%
ggplot(aes(year, mean, group = overall_condom_usage)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = overall_condom_usage), show.legend = T) +
geom_line(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
test_reduction == 0,
year > 2020,
overall_condom_usage %in% c(33.9)),
aes(year, mean, group = overall_condom_usage), linewidth = 0.75) +
geom_ribbon(data = filter(condom_change_summary,scenario == "intervention",
pitc_reduction_year == 2025,
indicator == "ARTcoverageAdult",
year > 2020,
test_reduction == 0,
overall_condom_usage %in% c(33.9)
), aes(ymin = lower_CI, ymax = upper_CI, fill = overall_condom_usage), alpha = 0.10, show.legend = F) +
xlab("") +
expand_limits(y=0) + theme_classic() +
theme(axis.text = element_text(size = 12),
axis.title.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
legend.text = element_text(size = 12),
plot.title = element_text(face = "bold", size = 12, hjust = 0.5)) +
ggtitle("Annual ART coverage") +
scale_y_continuous("ART coverage (%) \n(15+ years) \n", labels =(function(l) {round(l*1e2,1)})) +
scale_fill_manual(name = "Condom usage \nin 2035",
breaks = c(14.1, 20.4, 27.6,33.9, 42.4, 50.3, 58.2),
values = c(`14.1` = "#e41a1c", `20.4` = "#377eb8", `27.6` = "#4daf4a", `33.9` = "black", `42.4` = "#984ea3", `50.3` = "#ff7f00", `58.2` = "yellow3"),
labels= c("14.1%", "20.4%", "27.6%", "33.9% (Baseline)", "42.4%", "50.3%", "58.2%"),
aesthetics = c("colour", "fill"))
suppfig10 <- ggarrange(suppfig10a, suppfig10b, suppfig10c, suppfig10d, ncol = 2, nrow = 2, common.legend = TRUE, legend = "right", labels = "AUTO")
suppfig10
scales:::show_col(ggplotColours(n=3))
library(scales)
scales:::show_col(ggplotColours(n=3))
show_col(hue_pal()(4))
show_col(hue_pal()(5))
show_col(hue_pal()(6))
RColorBrewer::display.brewer.pal()
RColorBrewer::display.brewer.all()

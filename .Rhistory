xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of females aged > 15 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Adult females")
# number of FSW
df %>% filter(
scenario == "intervention",
indicator == "TotSexWorkers",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of FSW (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Total female sex workers")
df %>% filter(
scenario == "intervention",
indicator == "Pct_FSW_adult_females",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Adult females who are FSW (%)") +
ggtitle("Percentage of adult females who are FSW")
# FSW condom use
df %>% filter(
scenario == "intervention",
indicator == "FSWcondomUse",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Proportion of FSW who use condom") +
ggtitle("Proportion of FSW who use condom")
# number of FSW
df %>% filter(
scenario == "intervention",
indicator == "TotSexWorkers",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of FSW") +
ggtitle("Total female sex workers")
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
mutate(Pct_FSW_adult_females = ((TotSexWorkers / FemalesOver15)*100)) %>%
mutate(Sex_acts_per_FSW = SWsexActs/TotSexWorkers) %>%
mutate(Pct_adult_females = ((FemalesOver15/TotPop)*100)) %>%
pivot_longer(-(intervention_year:scenario), names_to = "indicator")
# save results
write.csv(df, "results/df.csv", row.names = FALSE)
df <- read.csv("results/df.csv")
df %>% filter(
scenario == "intervention",
indicator == "Pct_adult_females",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Adult females (%)") +
ggtitle("Percentage of population who are female adults")
# total population
df %>% filter(
scenario == "intervention",
indicator == "TotPop",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Total population (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Total population")
df %>% filter(
scenario == "intervention",
indicator == "Sex_acts_per_FSW",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of sex acts per FSW") +
ggtitle("Number of sex acts per FSW")
# number of adult males
df %>% filter(
scenario == "intervention",
indicator == "Pct_adult_males",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of males aged > 15 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Adult males")
# number of adult males
df %>% filter(
scenario == "intervention",
indicator == "malesOver15",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of males aged > 15 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Adult males")
# number of adult males
df %>% filter(
scenario == "intervention",
indicator == "MalesOver15",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of males aged > 15 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Adult males")
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
mutate(Pct_FSW_adult_females = ((TotSexWorkers / FemalesOver15)*100)) %>%
mutate(Sex_acts_per_FSW = SWsexActs/TotSexWorkers) %>%
mutate(Pct_adult_females = ((FemalesOver15/TotPop)*100)) %>%
mutate(Pct_adult_males = ((MalesOver15/TotPop)*100)) %>%
pivot_longer(-(intervention_year:scenario), names_to = "indicator")
df %>% filter(
scenario == "intervention",
indicator == "Pct_adult_males",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Adult males (%)") +
ggtitle("Percentage of population who are male adults")
output_names <- c("TotalHIVtests", "NewAdultHIV",
"AIDSdeathsAdultM", "AIDSdeathsAdultF", "TotalHIV",
"TotHIV15", "TotPop", "TotSexWorkers", "TotBirths", "MalesOver15" ,
"FemalesOver15", "FSWcondomUse", "SWsexActs", "MarriedM17to49")
dir.create("results", FALSE, TRUE)
# model input parameters
intervention_years <- 2025 # establish years PITC changes occur
base_rate_reduction = 1 # proportion of PITC base rate
sliding_scale_reduction = 0 # 10x percentage of sliding scale reduction
fsw_condom_usage_decrease = 0 # this is amount that fsw condom usage decreases by each year
st_condom_usage_decrease = 0 # this is amount that st condom usage decreases by each year
lt_condom_usage_decrease = 0 # this is amount that the condom usage decreases by each year
fsw_condom_usage_init = 0 # this is the value of the first year's fsw decrease
st_condom_usage_init = 0 # this is the value of the first year's st decrease
lt_condom_usage_init = 0 # this is the value of the first year's lt decrease
condom_incr_years = NA # these are the year for which condom usage decreases
art_interrupt_incr = 0 # this is amount that the art interruption rate decreases by each year
art_interrupt_init = 0 # this is the value of the first year's art interruption rate decrease
art_incr_years = 2025 # these are the year for which art interruption rate decreases
# run baseline model
baseline <- run_thembisa_scenario_future_variables(intervention_year = NA,
fsw_condom_usage_init = fsw_condom_usage_init,
st_condom_usage_init = st_condom_usage_init,
lt_condom_usage_init = lt_condom_usage_init,
fsw_condom_usage_decrease = 0,
st_condom_usage_decrease = 0,
lt_condom_usage_decrease = 0,
condom_incr_years = NA,
art_interrupt_init = art_interrupt_init,
art_interrupt_incr = NA,
art_incr_years = art_incr_years,
output_names = output_names,
base_rate_reduction = base_rate_reduction)
# save baseline outputs
write.csv(baseline, "results/baseline.csv", row.names = FALSE)
# for loop that changes testing rate at different years and saves outputs
for (percentage_value in sliding_scale_reduction){
art_interrupt_incr <- percentage_value/1000
art_interrupt_init <- percentage_value/1000
for (intervention_year in intervention_years){
art_incr_years <- seq(intervention_year, 2070, 1)
one_scenario <- run_thembisa_scenario_future_variables(intervention_year,
fsw_condom_usage_init = fsw_condom_usage_init,
st_condom_usage_init = st_condom_usage_init,
lt_condom_usage_init = lt_condom_usage_init,
fsw_condom_usage_decrease = fsw_condom_usage_decrease,
st_condom_usage_decrease = st_condom_usage_decrease,
lt_condom_usage_decrease = lt_condom_usage_decrease,
condom_incr_years = condom_incr_years,
art_interrupt_init = art_interrupt_init,
art_interrupt_incr = art_interrupt_incr,
art_incr_years = art_incr_years,
output_names,
base_rate_reduction)
write.csv(one_scenario, paste0("results/scenario_", intervention_year, "_", percentage_value,".csv"),
row.names = FALSE)
}
}
# make a new data frame joining all results
df <- read_thembisa_results_sliding_scale(intervention_years, sliding_scale_reduction)
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
mutate(Pct_FSW_adult_females = ((TotSexWorkers / FemalesOver15)*100)) %>%
mutate(Sex_acts_per_FSW = SWsexActs/TotSexWorkers) %>%
mutate(Pct_adult_females = ((FemalesOver15/TotPop)*100)) %>%
mutate(Pct_adult_males = ((MalesOver15/TotPop)*100)) %>%
pivot_longer(-(intervention_year:scenario), names_to = "indicator")
# save results
write.csv(df, "results/df.csv", row.names = FALSE)
df <- read.csv("results/df.csv")
# married men aged 17-49
df %>% filter(
scenario == "intervention",
indicator == "MarriedF17to49",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Married males aged 17-49 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Married males aged 17-49")
# married men aged 17-49
df %>% filter(
scenario == "intervention",
indicator == "MarriedF17to49",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Married males aged 17-49 (millions)") +
ggtitle("Married males aged 17-49")
View(df)
df %>% filter(
scenario == "intervention",
indicator == "MarriedF17to49",
year >= 2025)
# save baseline outputs
write.csv(baseline, "results/baseline.csv", row.names = FALSE)
# make a new data frame joining all results
df <- read_thembisa_results_sliding_scale(intervention_years, sliding_scale_reduction)
df <- df %>%
pivot_wider(names_from = indicator) %>%
mutate(TotalAIDSdeathsadult = AIDSdeathsAdultF + AIDSdeathsAdultM) %>%
mutate(Pct_FSW_adult_females = ((TotSexWorkers / FemalesOver15)*100)) %>%
mutate(Sex_acts_per_FSW = SWsexActs/TotSexWorkers) %>%
mutate(Pct_adult_females = ((FemalesOver15/TotPop)*100)) %>%
mutate(Pct_adult_males = ((MalesOver15/TotPop)*100)) %>%
pivot_longer(-(intervention_year:scenario), names_to = "indicator")
# save results
write.csv(df, "results/df.csv", row.names = FALSE)
df <- read.csv("results/df.csv")
# testing
df %>% filter(
scenario == "intervention",
indicator == "TotalHIVtests",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
ylab("Number of HIV tests") + expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of HIV tests (millions)", labels = (function(l) {round(l/1e6,1)}))
# number of adult females
df %>% filter(
scenario == "intervention",
indicator == "FemalesOver15",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of females aged > 15 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Adult females")
# number of adult males
df %>% filter(
scenario == "intervention",
indicator == "MalesOver15",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of males aged > 15 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Adult males")
# number of FSW
df %>% filter(
scenario == "intervention",
indicator == "TotSexWorkers",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of FSW (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Total female sex workers")
df %>% filter(
scenario == "intervention",
indicator == "Sex_acts_per_FSW",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of sex acts per FSW") +
ggtitle("Number of sex acts per FSW")
# number of FSW
df %>% filter(
scenario == "intervention",
indicator == "TotSexWorkers",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Number of FSW (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Total female sex workers")
df %>% filter(
scenario == "intervention",
indicator == "Pct_FSW_adult_females",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Adult females who are FSW (%)") +
ggtitle("Percentage of adult females who are FSW")
df %>% filter(
scenario == "intervention",
indicator == "Pct_adult_females",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Adult females (%)") +
ggtitle("Percentage of population who are female adults")
df %>% filter(
scenario == "intervention",
indicator == "Pct_adult_males",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Adult males (%)") +
ggtitle("Percentage of population who are male adults")
# married men aged 17-49
df %>% filter(
scenario == "intervention",
indicator == "MarriedF17to49",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Married males aged 17-49 (millions)") +
ggtitle("Married males aged 17-49")
df %>% filter(
scenario == "intervention",
indicator == "MarriedF17to49",
year >= 2025)
df %>% filter(
scenario == "intervention",
indicator == "Pct_adult_males",
year >= 2025)
# married men aged 17-49
df %>% filter(
scenario == "intervention",
indicator == "MarriedM17to49",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Married males aged 17-49 (millions)") +
ggtitle("Married males aged 17-49")
# married men aged 17-49
df %>% filter(
scenario == "intervention",
indicator == "MarriedM17to49",
year >= 2025) %>%
group_by(year, intervention_year, test_reduction) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
mutate(intervention_year = as.factor(intervention_year)) %>%
ggplot(aes(year, mean, group = intervention_year, fill = intervention_year)) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = F) +
geom_line(aes(colour = intervention_year), show.legend = F) +
xlab("Years") +
expand_limits(y=0) + theme_bw() + theme(text = element_text(size = 12)) +
scale_y_continuous("Married males aged 17-49 (millions)", labels = (function(l) {round(l/1e6,1)})) +
ggtitle("Married males aged 17-49")

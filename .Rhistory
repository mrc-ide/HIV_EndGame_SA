geom_point(aes(), show.legend = T) +
geom_errorbar(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
# Wrapped by intervention year
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean)) +
geom_point(aes(), show.legend = T) +
geom_errorbar(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean)) +
geom_point(aes(), show.legend = T) +
geom_errorbar(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean)) +
geom_line(aes(), show.legend = T) +
geom_errorbar(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean)) +
geom_line(aes(), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario != "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean)) +
geom_line(aes(), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario != "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, group = scenario)) +
geom_line(aes(), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario != "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, group = scenario)) +
geom_line(aes(colour = scenario), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = scenario), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Scenario") +
scale_fill_discrete("Scenario") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, group = scenario)) +
geom_line(aes(colour = scenario), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = scenario), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Scenario") +
scale_fill_discrete("Scenario") + ggtitle("Cumulative values over 20 years")
# Wrapped by intervention year
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean)) +
geom_point(aes(), show.legend = T) +
geom_errorbar(aes(ymin = lower_CI, ymax = upper_CI), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(vars(c(intervention_year)), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Change from baseline")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Change from baseline (%)")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Change from baseline over 20 years")
cumulative_values <- cumulative_values %>%
pivot_wider(names_from = scenario, values_from = cumulative) %>%
mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
mutate(absolute_dif = intervention - baseline)
cumulative_values <- cumulative_values %>%
pivot_wider(names_from = scenario, values_from = cumulative) %>%
mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
mutate(absolute_dif = intervention - baseline) %>%
pivot_longer(-(indicator:test_reduction), names_to = "scenario")
cumulative_values <- calc_all_cumulatives(intervention_years, 20)
cumulative_values <- cumulative_values %>%
pivot_wider(names_from = scenario, values_from = cumulative) %>%
mutate(percent_change = ((intervention - baseline)/baseline)*100) %>%
mutate(absolute_dif = intervention - baseline) %>%
pivot_longer(-(indicator:test_reduction), names_to = "scenario")
# Plotting 3 HIV indicators
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Change from baseline (%)")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Change from baseline over 20 years")
# Plotting 3 HIV indicators - absolute difference
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Difference from baseline (Mean [95% CI])")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Absolute difference from baseline over 20 years")
# Plotting 3 HIV indicators - absolute difference
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "absolute_dif", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Difference from baseline")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Absolute difference from baseline over 20 years")
# Plotting 3 HIV indicators - percent change
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalHIVtests"|
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Change from baseline (%)")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Change from baseline over 20 years")
# Plotting 2 HIV indicators
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "intervention", indicator == "NewAdultHIV" |
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Mean & 95% CI (millions)", labels = (function(l) {round(l/1e6,1)}))  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Cumulative values over 20 years")
# Plotting 2 HIV indicators - percent change
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "percent_change", indicator == "NewAdultHIV" |
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Change from baseline (%)")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Change from baseline over 20 years")
# Plotting 3 HIV indicators - absolute difference
# Wrapped by indicator
cumulative_values %>% filter(
scenario == "absolute_dif", indicator == "NewAdultHIV" |
indicator == "TotalAIDSdeathsadult") %>%
group_by(indicator, intervention_year, test_reduction, scenario) %>%
summarise(mean = mean(value), upper_CI = quantile(value, probs = 0.975),
lower_CI = quantile(value, probs = 0.025)) %>%
ggplot(aes(test_reduction, mean, fill = intervention_year)) +
geom_line(aes(color = intervention_year), show.legend = T) +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = intervention_year), alpha = 0.10, show.legend = T) +
xlab("% testing reduction") + scale_y_continuous("Difference from baseline")  +
facet_wrap(nrow = 1, vars(indicator), scales = "free_y",
labeller = labeller(indicator = c(
"TotalAIDSdeathsadult" = "AIDS-related mortality",
"TotalHIVtests" = "Total HIV tests",
"NewAdultHIV" = "New HIV infections",
"SWsexActs" = "FSW sex acts",
"SWsexActsProt" = "Protected FSW sex acts",
"TotProtSexActs" = "Total protected sex acts",
"TotSexActs" = "Total sex acts"
))) +
expand_limits(y=0) + theme_bw() + scale_color_discrete("Intervention year") +
scale_fill_discrete("Intervention year") + ggtitle("Absolute difference from baseline over 20 years")
